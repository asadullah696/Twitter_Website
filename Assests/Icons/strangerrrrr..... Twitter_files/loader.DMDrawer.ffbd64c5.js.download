(window.webpackJsonp=window.webpackJsonp||[]).push([[171],{"+Bsv":function(e,a,n){"use strict";var t=n("ERkP"),l=n.n(t),s=n("3XMw"),i=n.n(s),r=n("M2x3"),o="settingsAppBar",c=n("/yvb"),d=n("rHpw");const u=i.a.bb081ea1,h={viewType:"settings_button"},p=l.a.memo((({onPress:e,pullRight:a,to:n})=>l.a.createElement(c.a,{accessibilityLabel:u,behavioralEventContext:h,hoverLabel:{label:u},icon:l.a.createElement(r.a,null),link:n,onPress:e,pullRight:a,style:m.button,testID:o,type:"primaryText"}))),m=d.a.create((e=>({button:{marginVertical:`calc(-${e.spaces.space12})`}})));a.a=p},"23An":function(e,a,n){"use strict";var t=n("ERkP"),l=t.useEffect,s=t.useRef;e.exports=function(){var e=s(!0);return l((function(){return e.current=!0,function(){e.current=!1}}),[]),e}},"9SqB":function(e,a,n){"use strict";var t=n("IGGJ")(n("yiKp")),l=n("ERkP"),s=n("Ud88"),i=n("K1lQ").commitMutation,r=l.useState,o=l.useEffect,c=l.useRef,d=l.useCallback,u=n("23An");e.exports=function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i,n=s(),l=u(),h=c(n),p=c(e),m=c(new Set),g=r(!1),y=g[0],b=g[1],_=d((function(a){h.current===n&&p.current===e&&(m.current.delete(a),l.current&&b(m.current.size>0))}),[n,l,e]);o((function(){h.current===n&&p.current===e||(m.current=new Set,l.current&&b(!1),h.current=n,p.current=e)}),[n,l,e]);var v=d((function(s){var i=a(n,(0,t.default)((0,t.default)({},s),{},{mutation:e,onCompleted:function(e,a){_(i),s.onCompleted&&s.onCompleted(e,a)},onError:function(e){_(i),s.onError&&s.onError(e)},onUnsubscribe:function(){_(i),s.onUnsubscribe&&s.onUnsubscribe()}}));return m.current.add(i),l.current&&b(!0),i}),[_,a,n,l,e]);return[v,y]}},Avzu:function(e,a,n){"use strict";var t=n("ERkP"),l=n.n(t),s=n("Lsrn"),i=n("k/Ka");const r=(e={})=>Object(i.a)("svg",{...e,accessibilityHidden:void 0===e.accessibilityLabel,style:[s.a.root,e.style],viewBox:"0 0 24 24"},l.a.createElement("g",null,l.a.createElement("path",{d:"M23.25 3.25h-2.425V.825c0-.414-.336-.75-.75-.75s-.75.336-.75.75V3.25H16.9c-.414 0-.75.336-.75.75s.336.75.75.75h2.425v2.425c0 .414.336.75.75.75s.75-.336.75-.75V4.75h2.425c.414 0 .75-.336.75-.75s-.336-.75-.75-.75zm-3.175 6.876c-.414 0-.75.336-.75.75v8.078c0 .414-.337.75-.75.75H4.095c-.412 0-.75-.336-.75-.75V8.298l6.778 4.518c.368.246.79.37 1.213.37.422 0 .844-.124 1.212-.37l4.53-3.013c.336-.223.428-.676.204-1.012-.223-.332-.675-.425-1.012-.2l-4.53 3.014c-.246.162-.563.163-.808 0l-7.586-5.06V5.5c0-.414.337-.75.75-.75h9.094c.414 0 .75-.336.75-.75s-.336-.75-.75-.75H4.096c-1.24 0-2.25 1.01-2.25 2.25v13.455c0 1.24 1.01 2.25 2.25 2.25h14.48c1.24 0 2.25-1.01 2.25-2.25v-8.078c0-.415-.337-.75-.75-.75z"})));r.metadata={width:24,height:24},a.a=r},DbJc:function(e,a,n){"use strict";var t=n("VPAj");const l={...n("7n04").a,initialScrollHeadroom:Object(t.a)(0),scrollHeadroom:Object(t.a)(0),pinToNewestWhenAtNewest:!0};a.a=l},IpT4:function(e,a,n){"use strict";var t=n("ERkP"),l=n.n(t),s=n("Lsrn"),i=n("k/Ka");const r=(e={})=>Object(i.a)("svg",{...e,accessibilityHidden:void 0===e.accessibilityLabel,style:[s.a.root,e.style],viewBox:"0 0 24 24"},l.a.createElement("g",null,l.a.createElement("path",{d:"M22.238 2.257c-.293-.293-.768-.293-1.06 0L2.52 20.917c-.293.292-.293.767 0 1.06.146.146.338.22.53.22s.384-.073.53-.22l18.658-18.66c.293-.293.293-.767 0-1.06zM2.986 17.82c.155 0 .312-.048.446-.148.112-.083 2.752-2.104 2.708-7.248-.02-2.16.643-3.98 1.913-5.266 1.093-1.107 2.577-1.72 4.18-1.727 1.325.006 2.562.42 3.578 1.195.137.104.297.153.455.153.227 0 .45-.102.598-.295.25-.33.188-.8-.142-1.052-1.278-.975-2.828-1.493-4.483-1.5h-.003c-2.008.008-3.87.78-5.248 2.173-1.536 1.551-2.368 3.8-2.348 6.332.037 4.33-2.02 5.967-2.103 6.03-.332.247-.4.718-.154 1.05.147.2.374.303.603.303zm16.844-7.382c.002-.246-.003-.487-.017-.723-.024-.414-.387-.74-.792-.706-.413.023-.728.378-.705.79.012.205.017.413.015.624-.024 2.868.785 4.765 1.526 5.896h-8.314c-.414 0-.75.336-.75.75s.336.75.75.75h3.522c-.1 1.48-1.323 2.66-2.828 2.66-1.003 0-1.913-.514-2.436-1.372-.214-.354-.675-.467-1.03-.25-.354.214-.467.675-.25 1.03.795 1.31 2.185 2.09 3.716 2.09 2.332 0 4.227-1.85 4.328-4.158h4.922c.32 0 .604-.206.707-.51.104-.305 0-.643-.255-.84-.087-.066-2.145-1.7-2.108-6.032z"})));r.metadata={width:24,height:24},a.a=r},"ShJ/":function(e,a,n){"use strict";var t=n("ERkP"),l=n.n(t),s=n("Lsrn"),i=n("k/Ka");const r=(e={})=>Object(i.a)("svg",{...e,accessibilityHidden:void 0===e.accessibilityLabel,style:[s.a.root,e.style],viewBox:"0 0 24 24"},l.a.createElement("g",null,l.a.createElement("path",{d:"M20.472 14.738c-.388-1.808-2.24-3.517-3.908-4.246l-.474-4.307 1.344-2.016c.258-.387.28-.88.062-1.286-.218-.406-.64-.66-1.102-.66H7.54c-.46 0-.884.254-1.1.66-.22.407-.197.9.06 1.284l1.35 2.025-.42 4.3c-1.667.732-3.515 2.44-3.896 4.222-.066.267-.043.672.222 1.01.14.178.46.474 1.06.474h3.858l2.638 6.1c.12.273.39.45.688.45s.57-.177.688-.45l2.638-6.1h3.86c.6 0 .92-.297 1.058-.474.265-.34.288-.745.228-.988zM12 20.11l-1.692-3.912h3.384L12 20.11zm-6.896-5.413c.456-1.166 1.904-2.506 3.265-2.96l.46-.153.566-5.777-1.39-2.082h7.922l-1.39 2.08.637 5.78.456.153c1.355.45 2.796 1.78 3.264 2.96H5.104z"})));r.metadata={width:24,height:24},a.a=r},X8um:function(e,a,n){"use strict";n.r(a);const t={fragment:{argumentDefinitions:l=[{defaultValue:null,kind:"LocalArgument",name:"label"}],kind:"Fragment",metadata:null,name:"DMPinnedInboxQuery",selections:[{alias:"labeled_conversation_slice",args:s=[{kind:"Variable",name:"label",variableName:"label"},{kind:"Literal",name:"s",value:18}],concreteType:"DMLabeledConversationsSlice",kind:"LinkedField",name:"__DMPinnedInboxQuery_labeled_conversation_slice_slice",plural:!1,selections:[{alias:null,args:null,concreteType:"DMConversation",kind:"LinkedField",name:"items",plural:!0,selections:[i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"rest_id",storageKey:null},{alias:null,args:null,concreteType:"ConversationInfo",kind:"LinkedField",name:"legacy",plural:!1,selections:[o={alias:null,args:null,kind:"ScalarField",name:"conversation_id",storageKey:null},{alias:null,args:null,concreteType:"ConversationMetadata",kind:"LinkedField",name:"metadata",plural:!1,selections:[o,c={alias:null,args:null,kind:"ScalarField",name:"conversation_type",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"created_at_millis",storageKey:null},{alias:null,args:null,concreteType:"ApiMedia",kind:"LinkedField",name:"avatar",plural:!1,selections:[i,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"media_info",plural:!1,selections:[h={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"original_img_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"original_img_width",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"original_img_height",storageKey:null}],type:"ApiImage",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ParticipantConversationMetadata",kind:"LinkedField",name:"participants_metadata",plural:!0,selections:[{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"user_results",plural:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"result",plural:!1,selections:[{kind:"InlineFragment",selections:[i,r,p={alias:null,args:null,concreteType:"ApiUser",kind:"LinkedField",name:"legacy",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id_str",storageKey:null},d,{alias:null,args:null,kind:"ScalarField",name:"screen_name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profile_image_url_https",storageKey:null}],storageKey:null}],type:"User",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null},m={alias:null,args:null,concreteType:"PerspectivalConversationMetadata",kind:"LinkedField",name:"perspectival_conversation_metadata",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"last_read_event_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"low_quality",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"muted",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"muted_due_to_muted_user",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"read_only",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"trusted",storageKey:null}],storageKey:null}],storageKey:null},g={alias:null,args:null,concreteType:"DMConversationLabelInfo",kind:"LinkedField",name:"labels",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"label_type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null}],storageKey:null}],storageKey:null},y={alias:null,args:null,concreteType:"SliceInfo",kind:"LinkedField",name:"slice_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"next_cursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"previous_cursor",storageKey:null}],storageKey:null},b={kind:"ClientExtension",selections:[{alias:null,args:null,kind:"ScalarField",name:"__id",storageKey:null}]}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:l,kind:"Operation",name:"DMPinnedInboxQuery",selections:[{alias:null,args:s,concreteType:"DMLabeledConversationsSlice",kind:"LinkedField",name:"labeled_conversation_slice",plural:!1,selections:[{alias:null,args:null,concreteType:"DMConversation",kind:"LinkedField",name:"items",plural:!0,selections:[i,r,{alias:null,args:null,concreteType:"ConversationInfo",kind:"LinkedField",name:"legacy",plural:!1,selections:[o,{alias:null,args:null,concreteType:"ConversationMetadata",kind:"LinkedField",name:"metadata",plural:!1,selections:[o,c,d,u,{alias:null,args:null,concreteType:"ApiMedia",kind:"LinkedField",name:"avatar",plural:!1,selections:[i,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"media_info",plural:!1,selections:[_={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},h],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ParticipantConversationMetadata",kind:"LinkedField",name:"participants_metadata",plural:!0,selections:[{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"user_results",plural:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"result",plural:!1,selections:[_,{kind:"InlineFragment",selections:[i,r,p,{alias:null,args:null,filters:null,handle:"defaultScalars",key:"",kind:"LinkedHandle",name:"legacy"}],type:"User",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null},m],storageKey:null},g],storageKey:null},y,b],storageKey:null},{alias:null,args:s,filters:["label","s"],handle:"slice",key:"DMPinnedInboxQuery_labeled_conversation_slice",kind:"LinkedHandle",name:"labeled_conversation_slice",handleArgs:[{kind:"Literal",name:"itemsFieldName",value:"items_results"}]}]},params:{id:"cKsXL-p1VWDQbomSDV2bAg",metadata:{sliceInfoPath:["labeled_conversation_slice","slice_info"]},name:"DMPinnedInboxQuery",operationKind:"query",text:null}};var l,s,i,r,o,c,d,u,h,p,m,g,y,b,_;t.hash="ce2e2976cf1d1610f3238a158593facf",a.default=t},YemM:function(e,a,n){"use strict";const t=n("rHpw").a.create((e=>({root:{backgroundColor:e.colors.cellBackground,paddingHorizontal:e.componentDimensions.gutterHorizontal,paddingVertical:e.spaces.space16,width:"100%"},active:{backgroundColor:e.colors.gray0},bodyColumn:{flexDirection:"row"},inlineTimestamp:{flexDirection:"row"},inlineTimestampVDL:{flexDirection:"row",alignItems:"center"},titleContainer:{flex:1},inlineNotificationsDisabledIcon:{paddingLeft:`calc(${e.spaces.space2} * 3)`,color:e.colors.gray700},inlineNotificationsDisabledIconVDL:{width:e.spaces.space16,height:e.spaces.space16},hiddenMenu:{opacity:0,overflow:"hidden",width:0},menu:{alignSelf:"flex-start"},menuContainer:{height:0,marginLeft:`calc(${e.spaces.space8} + ${e.spaces.space2})`},notificationsDisabledIcon:{alignSelf:"flex-end",color:e.colors.gray700,paddingTop:e.spaces.space4},unreadMessagePip:{backgroundColor:e.colors.blue500,marginTop:`calc(${e.spaces.space8} - ${e.spaces.space1})`,height:e.baseFontSize-5,width:e.baseFontSize-5},vdlXButton:{border:"none",marginLeft:`calc(${e.spaces.space8} + ${e.spaces.space2})`,marginRight:`calc(-1 * ${e.spaces.space4})`,marginTop:`calc(-1 * (${e.spaces.space8} - ${e.spaces.space1}))`},xButton:{alignSelf:"center",marginRight:`calc(-1 * ${e.spaces.space4})`},xIcon:{height:`calc(${e.spaces.space28} - ${e.spaces.space1})`,width:`calc(${e.spaces.space28} - ${e.spaces.space1})`},trashcanIcon:{color:e.colors.gray700},snippet:{maxHeight:e.spaces.space40,overflow:"hidden"},snippetPadding:{paddingRight:`calc(${e.spaces.space28} + ${e.spaces.space1} * 0.75)`},unread:{backgroundColor:e.colors.unreadCellBackground},socialProofContainer:{marginTop:e.spaces.space4},socialProofText:{marginLeft:0},convoLabelIcon:{marginRight:e.spaces.space4},endCell:{marginLeft:e.spaces.space16}})));a.a=t},ZH9U:function(e,a,n){"use strict";n.r(a);const t={fragment:{argumentDefinitions:l=[{defaultValue:null,kind:"LocalArgument",name:"conversation_id"},{defaultValue:null,kind:"LocalArgument",name:"label"}],kind:"Fragment",metadata:null,name:"DMPinnedInboxAppend_Mutation",selections:s=[{alias:null,args:[{kind:"Variable",name:"conversation_id",variableName:"conversation_id"},{kind:"Variable",name:"label",variableName:"label"},{kind:"Literal",name:"s",value:18}],concreteType:null,kind:"LinkedField",name:"add_dm_conversation_label_v3",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"label_type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null}],type:"DMConversationLabelInfo",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"failure_reason",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"message",storageKey:null}],type:"DMConversationLabelUnavailable",abstractKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:l,kind:"Operation",name:"DMPinnedInboxAppend_Mutation",selections:s},params:{id:"o0aymgGiJY-53Y52YSUGVA",metadata:{},name:"DMPinnedInboxAppend_Mutation",operationKind:"mutation",text:null}};var l,s;t.hash="86e5601441f8d07b68ccbcf112746d23",a.default=t},d9IC:function(e,a,n){"use strict";var t=n("ERkP"),l=n.n(t),s=n("3XMw"),i=n.n(s),r=n("Irs7"),o=n("MWbm"),c=n("/yvb"),d=n("t62R"),u=n("rHpw");const h=i.a.b08821f3,p=i.a.e047b8fa,m=u.a.create((e=>({root:{backgroundColor:e.colors.cellBackground,paddingLeft:e.spaces.space16,paddingVertical:e.spaces.space4,alignItems:"center",flexDirection:"row",justifyContent:"space-between",borderBottomStyle:"solid",borderBottomWidth:e.borderWidths.small,borderBottomColor:e.colors.borderColor},backButton:{marginRight:e.spaces.space4},iconContainer:{alignItems:"center",flexDirection:"row"},icon:{color:e.colors.text,marginRight:e.spaces.space12,fontSize:e.fontSizes.body,marginVertical:e.spaces.space8},labelHeader:{borderBottomStyle:"none",paddingVertical:e.spaces.space12}})));a.a=e=>{const a=Object(r.b)(),{clearRecentSearches:n,headerText:t,icon:s,isInboxLabelHeader:i,withClearButton:u}=e;l.a.useEffect((()=>{a.scribe({component:"recent_search",action:"impression"})}),[a]);const g=[m.root,i&&m.labelHeader];return l.a.createElement(o.a,{style:g},l.a.createElement(o.a,{style:m.iconContainer},(()=>{const e=s;return e?l.a.createElement(e,{style:m.icon}):null})(),l.a.createElement(d.b,{accessibilityLevel:2,accessibilityRole:"heading",size:"headline1",weight:"heavy"},t)),u?l.a.createElement(c.a,{accessibilityLabel:h,onPress:n,style:m.backButton,type:"onMediaWhiteFilled"},p):null)}},fQBn:function(e,a,n){"use strict";var t=n("ERkP"),l=n.n(t),s=n("t62R"),i=n("MMRb"),r=n("hqKg"),o=n("g54k"),c=n("G6rE"),d=n("rxPX");const u=(e,a)=>a.entry;var h=Object(d.a)().propsFromState((()=>({users:Object(r.createSelector)(c.e.selectAll,u,o.b)}))).adjustStateProps((({users:e})=>({...e}))),p=n("zQEV"),m=n("4n2h");var g=h((({entry:e,entryType:a,isSelected:n=!1,perspective:t,unread:i=!1,users:r})=>{const o=Object(p.a)(e,a,t,r),c=Object(m.b)(i),d=Object(m.a)(i,n);return l.a.createElement(s.b,{color:d,weight:c},o)})),y=n("v6aA"),b=n("oEGd");const _=Object(r.createSelector)(((e,a)=>c.e.select(e,a.senderId)),((e,a)=>a.recipientId?c.e.select(e,a.recipientId):void 0),((e,a)=>({user:e,recipient:a})));var v=Object(b.c)(_),k=n("X/yg"),E=n("cTG8"),f=n("3XMw"),S=n.n(f);const I=e=>l.a.createElement(S.a.I18NFormatMessage,{$i18n:"b3a2b11c"},l.a.createElement(s.b,null,e)),C=S.a.dedfd265;const F=S.a.a876e58b,x=S.a.bf584cd1,T=S.a.a9cc8cfd,w=S.a.e20b65b0,L=S.a.e5bfe07d,K=S.a.b1a614fe;var M=v((({entry:e,perspective:a,isGroupDM:n,unread:t=!1,user:i={},recipient:r={},isSelected:o=!1})=>{const{featureSwitches:c}=l.a.useContext(y.a),d=e&&e.message_data;if(!d)return null;const{attachment:u}=d,h=u&&!!(u.video||u.photo||u.animated_gif||u.tweet||u.fleet||u.sticker||u.card),p=a===i.id_str,g=!(!h||!p)||!(!n||p),b=i.name,_=r.name,v=Object(m.b)(t),f=Object(m.a)(t,o);let M=[g&&l.a.createElement(s.b,{key:"senderName"},I(b)," "),d&&d.text&&l.a.createElement(E.a,{displayTextRange:[0,d.text.length],entities:d.entities,key:"message",text:d.text,withMediaLinks:!0})];return u&&(u.tweet?M=g?((e,a)=>e?l.a.createElement(s.b,null,S.a.d5b762c8):l.a.createElement(S.a.I18NFormatMessage,{$i18n:"dfd2b3b9"},l.a.createElement(s.b,null,a)))(p,b):K:u.fleet?M=((e,a,n)=>e?l.a.createElement(S.a.I18NFormatMessage,{$i18n:"i005f1fd"},l.a.createElement(s.b,null,a),l.a.createElement(s.b,null,n||"")):l.a.createElement(S.a.I18NFormatMessage,{$i18n:"b35cee40"},l.a.createElement(s.b,null,n||"")))(p,_,d.text):u.video?M=Object(k.l)(u,c)?g?function(e,a){return e?l.a.createElement(s.b,null,S.a.h7033cac):l.a.createElement(S.a.I18NFormatMessage,{$i18n:"be5a9616"},l.a.createElement(s.b,null,a))}(p,b):C:g?((e,a)=>e?l.a.createElement(s.b,null,S.a.j7d81019):l.a.createElement(S.a.I18NFormatMessage,{$i18n:"eee2f120"},l.a.createElement(s.b,null,a)))(p,b):F:u.photo?M=g?((e,a)=>e?l.a.createElement(s.b,null,S.a.f80629ba):l.a.createElement(S.a.I18NFormatMessage,{$i18n:"c1e1f848"},l.a.createElement(s.b,null,a)))(p,b):x:u.animated_gif?M=g?((e,a)=>e?l.a.createElement(s.b,null,S.a.eb3d722e):l.a.createElement(S.a.I18NFormatMessage,{$i18n:"dc4b75a1"},l.a.createElement(s.b,null,a)))(p,b):T:u.sticker?M=g?((e,a)=>e?l.a.createElement(s.b,null,S.a.d30c2d4f):l.a.createElement(S.a.I18NFormatMessage,{$i18n:"c7e2464e"},l.a.createElement(s.b,null,a)))(p,b):w:u.card&&(M=g?((e,a)=>e?l.a.createElement(s.b,null,S.a.db53c017):l.a.createElement(S.a.I18NFormatMessage,{$i18n:"hcbbbb34"},l.a.createElement(s.b,null,a)))(p,b):L)),l.a.createElement(s.b,{color:f,numberOfLines:1,weight:v},M)})),D=n("uKEd");const R=(e,a)=>a.senderId?c.e.select(e,a.senderId):void 0,O=(e,a)=>Object(D.n)(e,a.reactionEntry.message_id),P=(e,a)=>{const n=O(e,a);return n&&n.message_data&&c.e.select(e,n.message_data.sender_id)};var A=Object(b.e)((()=>Object(r.createSelector)(R,O,P,((e,a,n)=>({reactedMessageEntry:a,reactingUser:e,messageUser:n})))),{}),N=n("33Kz");var H=A((({isGroupDM:e,isSelected:a=!1,messageUser:n,perspective:t,reactedMessageEntry:i,reactingUser:r,reactionEntry:o,unread:c=!1})=>{const{featureSwitches:d}=l.a.useContext(y.a),u=i&&i.message_data,h=u&&u.attachment,p=u&&u.text,g=n&&n.screen_name,b=t===(r&&r.id_str),_=r&&r.name,v=Object(N.b)(o.reaction_key||"",d),k=Object(m.b)(c),E=Object(m.a)(c,a);let f;return f=h&&h.tweet?e?((e,a,n,t)=>e?l.a.createElement(S.a.I18NFormatMessage,{$i18n:"c4202784"},l.a.createElement(s.b,null,n),l.a.createElement(s.b,null,t)):l.a.createElement(S.a.I18NFormatMessage,{$i18n:"b493a890"},l.a.createElement(s.b,null,a),l.a.createElement(s.b,null,n),l.a.createElement(s.b,null,t)))(b,_,g,v):((e,a,n)=>e?l.a.createElement(S.a.I18NFormatMessage,{$i18n:"ca684bf5"},l.a.createElement(s.b,null,n)):l.a.createElement(S.a.I18NFormatMessage,{$i18n:"h5797be5"},l.a.createElement(s.b,null,a),l.a.createElement(s.b,null,n)))(b,_,v):h&&h.video?e?((e,a,n,t)=>e?l.a.createElement(S.a.I18NFormatMessage,{$i18n:"d1f8bdd9"},l.a.createElement(s.b,null,n),l.a.createElement(s.b,null,t)):l.a.createElement(S.a.I18NFormatMessage,{$i18n:"d764af97"},l.a.createElement(s.b,null,a),l.a.createElement(s.b,null,n),l.a.createElement(s.b,null,t)))(b,_,g,v):((e,a,n)=>e?l.a.createElement(S.a.I18NFormatMessage,{$i18n:"ab1cdfe2"},l.a.createElement(s.b,null,n)):l.a.createElement(S.a.I18NFormatMessage,{$i18n:"f0cf1699"},l.a.createElement(s.b,null,a),l.a.createElement(s.b,null,n)))(b,_,v):h&&h.photo?e?((e,a,n,t)=>e?l.a.createElement(S.a.I18NFormatMessage,{$i18n:"hec0fd4d"},l.a.createElement(s.b,null,n),l.a.createElement(s.b,null,t)):l.a.createElement(S.a.I18NFormatMessage,{$i18n:"j55320de"},l.a.createElement(s.b,null,a),l.a.createElement(s.b,null,n),l.a.createElement(s.b,null,t)))(b,_,g,v):((e,a,n)=>e?l.a.createElement(S.a.I18NFormatMessage,{$i18n:"jf27606a"},l.a.createElement(s.b,null,n)):l.a.createElement(S.a.I18NFormatMessage,{$i18n:"cd110359"},l.a.createElement(s.b,null,a),l.a.createElement(s.b,null,n)))(b,_,v):h&&h.animated_gif?e?((e,a,n,t)=>e?l.a.createElement(S.a.I18NFormatMessage,{$i18n:"e70dcc35"},l.a.createElement(s.b,null,n),l.a.createElement(s.b,null,t)):l.a.createElement(S.a.I18NFormatMessage,{$i18n:"g1bf440b"},l.a.createElement(s.b,null,a),l.a.createElement(s.b,null,n),l.a.createElement(s.b,null,t)))(b,_,g,v):((e,a,n)=>e?l.a.createElement(S.a.I18NFormatMessage,{$i18n:"b2da1bf8"},l.a.createElement(s.b,null,n)):l.a.createElement(S.a.I18NFormatMessage,{$i18n:"g84c0421"},l.a.createElement(s.b,null,a),l.a.createElement(s.b,null,n)))(b,_,v):h&&h.card?e?((e,a,n,t)=>e?l.a.createElement(S.a.I18NFormatMessage,{$i18n:"cd2e7c18"},l.a.createElement(s.b,null,n),l.a.createElement(s.b,null,t)):l.a.createElement(S.a.I18NFormatMessage,{$i18n:"aee9e7fa"},l.a.createElement(s.b,null,a),l.a.createElement(s.b,null,n),l.a.createElement(s.b,null,t)))(b,_,g,v):((e,a,n)=>e?l.a.createElement(S.a.I18NFormatMessage,{$i18n:"f9fb1cf6"},l.a.createElement(s.b,null,n)):l.a.createElement(S.a.I18NFormatMessage,{$i18n:"f2bf910e"},l.a.createElement(s.b,null,a),l.a.createElement(s.b,null,n)))(b,_,v):p?e?((e,a,n,t,i)=>e?l.a.createElement(S.a.I18NFormatMessage,{$i18n:"i6cec545"},l.a.createElement(s.b,null,t),l.a.createElement(s.b,null,n),l.a.createElement(s.b,null,i)):l.a.createElement(S.a.I18NFormatMessage,{$i18n:"d6998baa"},l.a.createElement(s.b,null,a),l.a.createElement(s.b,null,t),l.a.createElement(s.b,null,n),l.a.createElement(s.b,null,i)))(b,_,v,g,p):((e,a,n,t)=>e?l.a.createElement(S.a.I18NFormatMessage,{$i18n:"cec676f3"},l.a.createElement(s.b,null,n),l.a.createElement(s.b,null,t)):l.a.createElement(S.a.I18NFormatMessage,{$i18n:"a2706f9a"},l.a.createElement(s.b,null,a),l.a.createElement(s.b,null,n),l.a.createElement(s.b,null,t)))(b,_,v,p):((e,a,n)=>e?l.a.createElement(S.a.I18NFormatMessage,{$i18n:"d6b15bbf"},l.a.createElement(s.b,null,n)):l.a.createElement(S.a.I18NFormatMessage,{$i18n:"ac0d4bc7"},l.a.createElement(s.b,null,a),l.a.createElement(s.b,null,n)))(b,_,v),l.a.createElement(s.b,{color:E,numberOfLines:1,weight:k},f)})),U=n("H4nC"),B=n("b9JY");const j=S.a.fb3ccb55;a.a=({conversationType:e,entry:a,isSelected:n=!1,perspective:t,unread:r})=>{if(a.marked_as_spam){const e=Object(m.b)(r),a=Object(m.a)(r,n);return l.a.createElement(s.b,{color:a,numberOfLines:1,weight:e},j)}if(Object(B.b)(a)){const{message_data:{recipient_id:s,sender_id:o}={}}=a;return l.a.createElement(M,{entry:a,isGroupDM:e===i.CONVERSATION_TYPE.GROUP,isSelected:n,perspective:t,recipientId:s,senderId:o,unread:r})}return Object(B.c)(a)?l.a.createElement(H,{isGroupDM:e===i.CONVERSATION_TYPE.GROUP,isSelected:n,perspective:t,reactionEntry:a,senderId:a.sender_id,unread:r}):Object(B.a)(a)?l.a.createElement(g,{entry:a,entryType:a.type,isSelected:n,perspective:t,unread:r}):Object(B.d)(a)?l.a.createElement(U.a,{entry:a,isCompact:!0,isSelected:n,unread:r}):null}},fuhe:function(e,a,n){"use strict";n.r(a),n.d(a,"DMDrawer",(function(){return Xe}));var t=n("97Jx"),l=n.n(t),s=(n("kYxP"),n("ERkP")),i=n.n(s),r=n("ZUOq"),o=n("MMRb"),c=n("RqPI"),d=n("rxPX"),u=n("0KEI");var h=Object(d.a)().propsFromState((()=>({conversations:o.selectConversations,drawerExperimentEnabled:o.selectDrawerExperimentEnabled,perspective:c.r,poppedOutConversationId:o.selectPoppedOutConversationId,visibility:o.selectDrawerVisibility}))).propsFromActions((()=>({createLocalApiErrorHandler:Object(u.createLocalApiErrorHandlerWithContextFactory)("DIRECT_MESSAGES_CONVERSATION"),fetchInboxIfNeeded:o.fetchInboxIfNeeded,loadDrawerVisibilityFromPersistence:o.loadDrawerVisibilityFromPersistence,setDrawerVisibility:o.setDrawerVisibility}))),p=n("V/6K"),m=n("CDB5"),g=n("1YZw"),y=n("hqKg"),b=n("X/yg"),_=n("AQOc"),v=n("UhuB"),k=n("l0YN"),E=n("G6rE"),f=n("P1r1");const S=(e,a)=>a.conversationId,I=Object(y.createSelector)(((e,a)=>o.selectEntriesForConversation(e,S(0,a))),c.r,((e,a)=>a?Object(b.e)(e,a):void 0)),C=e=>a=>m.c(e,a),F=e=>(a,n)=>m.a(e,a,n),x={conversation:(e,a)=>o.selectConversation(e,S(0,a)),entries:o.selectEntries,perspective:c.r,users:E.e.selectAll,dataSaverMode:f.j,dtabBarInfo:f.m,quickReplyOptions:I,visibility:o.selectDrawerVisibility,inboxUnreadCount:k.a,isUnread:(e,a)=>!o.selectConversationIsRead(e,S(0,a)),isDmReceiptSettingEnabled:v.n},T={draftText:(e,a)=>m.l(e,S(0,a)),gifMetadata:(e,a)=>m.h(e,S(0,a)),isUploading:(e,a)=>m.j(e,S(0,a)),media:(e,a)=>m.i(e,S(0,a)),mediaUploadProgress:(e,a)=>m.k(e,S(0,a))};var w=Object(d.a)().propsFromState((()=>({...x,...T}))).adjustStateProps((({conversation:e,dataSaverMode:a,draftText:n,dtabBarInfo:t,entries:l,gifMetadata:s,inboxUnreadCount:i,isDmReceiptSettingEnabled:r,isUnread:o,isUploading:c,media:d,mediaUploadProgress:u,perspective:h,quickReplyOptions:p,users:m,visibility:g})=>{const y=null==e?void 0:e.data;return{conversation:y&&Object(_.a)(y,l,m),perspective:h,dataSaverMode:a,draftText:n,dtabBarInfo:t,gifMetadata:s,inboxUnreadCount:i,isDmReceiptSettingEnabled:r,isUploading:c,isUnread:o,media:d,mediaUploadProgress:u,quickReplyOptions:p,visibility:g}})).propsFromActions((({conversationId:e})=>({addMedia:F(e),addToast:g.b,createLocalApiErrorHandler:Object(u.createLocalApiErrorHandlerWithContextFactory)("DIRECT_MESSAGES_CONVERSATION"),fetchConversationHistory:o.fetchConversationHistory,removeMedia:C(e),saveText:m.f,sendMessage:m.m,updateConversationReadState:o.updateConversationReadState,updateTyping:o.updateTyping,fetchUpdatesIfNeeded:o.fetchUpdatesIfNeeded}))).withAnalytics({page:"messages",section:"thread_drawer"}),L=n("aWyx"),K=n("qz2E"),M=n("Oi4X"),D=n("OhSZ"),R=Object(d.a)().propsFromState((()=>({visibility:o.selectDrawerVisibility}))).propsFromActions((()=>({popOutConversation:o.popOutConversation,setDrawerVisibility:o.setDrawerVisibility}))).withAnalytics(),O=n("AQ79"),P=n("3XMw"),A=n.n(P),N=n("OrGc"),H=n("hACr"),U=n("fs1G"),B=n("MWbm"),j=n("/yvb"),V=n("Znyr"),z=n("t62R"),q=n("xKuM"),Q=n("rHpw"),G=n("v6aA"),W=n("95Se"),$=n("Avzu"),Y=n("Lsrn"),X=n("k/Ka");const Z=(e={})=>Object(X.a)("svg",{...e,accessibilityHidden:void 0===e.accessibilityLabel,style:[Y.a.root,e.style],viewBox:"0 0 24 24"},i.a.createElement("g",null,i.a.createElement("path",{d:"M12 19.344l-8.72-8.72c-.293-.293-.768-.293-1.06 0s-.294.768 0 1.06l9.25 9.25c.292.294.767.294 1.06 0l9.25-9.25c.146-.145.22-.337.22-.53s-.073-.383-.22-.53c-.293-.292-.768-.292-1.06 0L12 19.344z"}),i.a.createElement("path",{d:"M12 11.535l-8.72-8.72c-.293-.293-.768-.293-1.06 0s-.294.768 0 1.06l9.25 9.25c.292.294.767.294 1.06 0l9.25-9.25c.146-.145.22-.337.22-.53s-.073-.383-.22-.53c-.293-.292-.768-.292-1.06 0L12 11.535z"})));Z.metadata={width:24,height:24};var J=Z;const ee=(e={})=>Object(X.a)("svg",{...e,accessibilityHidden:void 0===e.accessibilityLabel,style:[Y.a.root,e.style],viewBox:"0 0 24 24"},i.a.createElement("g",null,i.a.createElement("path",{d:"M12 4.656l8.72 8.72c.293.293.768.293 1.06 0s.294-.768 0-1.06l-9.25-9.25c-.292-.294-.767-.294-1.06 0l-9.25 9.25c-.146.145-.22.337-.22.53s.073.383.22.53c.293.292.768.292 1.06 0L12 4.656z"}),i.a.createElement("path",{d:"M12 12.465l8.72 8.72c.293.293.768.293 1.06 0s.294-.768 0-1.06l-9.25-9.25c-.292-.294-.767-.294-1.06 0l-9.25 9.25c-.146.145-.22.337-.22.53s.073.383.22.53c.293.292.768.292 1.06 0l8.72-8.72z"})));ee.metadata={width:24,height:24};var ae=ee,ne=n("x0mb");const te=A.a.a2f8105f,le=A.a.d227d19e,se=A.a.c64c1883,ie=A.a.j7d0e835,re=A.a.b08821f3,oe=A.a.e736990a,ce=A.a.cdcebd22;class de extends i.a.Component{constructor(...e){super(...e),this._headerBar=i.a.createRef(),this._isExpanded=()=>{const{visibility:e}=this.props;return e===O.b.EXPANDED},this._renderLeftControl=()=>{const{inboxUnreadCount:e}=this.props;return i.a.createElement(B.a,null,i.a.createElement(j.a,{accessibilityLabel:re,icon:i.a.createElement(W.a,null),onPress:this._handleUnpopConvo,type:this._getButtonType()}),e&&e>0?i.a.createElement(V.a,{pip:!0,style:ue.newMessagePip,truncatedCountFormatter:()=>"",unreadCountLabel:()=>""}):null)},this._getButtonType=()=>{const{hasNewMessages:e,isHighlighted:a}=this.props;return a&&e?"onMediaText":"primaryText"},this._renderRightControl=()=>{const{conversationTitle:e}=this.props,a=this._isExpanded(),n=this._getButtonType();return i.a.createElement(B.a,{style:ue.rightControls},e?null:i.a.createElement(j.a,{accessibilityLabel:se,hoverLabel:{label:ce},icon:i.a.createElement($.a,null),onPress:this._handleNewMessage,type:n}),a?i.a.createElement(j.a,{accessibilityLabel:le,hoverLabel:{label:le},icon:i.a.createElement(J,null),onPress:this._handleToggleVisibility,type:n}):i.a.createElement(j.a,{accessibilityLabel:ie,hoverLabel:{label:ie},icon:i.a.createElement(ae,null),onPress:this._handleToggleVisibility,type:n}))},this._handleUnpopConvo=()=>{const{popOutConversation:e}=this.props;e(null)},this._handleToggleVisibility=()=>{const{analytics:e,onDrawerOpen:a,setDrawerVisibility:n}=this.props,t=this._isExpanded()?O.b.COLLAPSED:O.b.EXPANDED;t===O.b.COLLAPSED?e.scribe({action:"collapse"}):t===O.b.EXPANDED&&(e.scribe({action:"expand"}),a&&a()),n(t)},this._handleToggleVisibilityKeyboard=()=>{this._handleToggleVisibility(),this._headerBar&&this._headerBar.current&&this._headerBar.current.focus()},this._handleNewMessage=()=>{const{analytics:e,history:a}=this.props;e.scribe({section:"compose_drawer",component:"dm",action:"show"}),a.push({pathname:"/messages/compose",state:{source:"drawer"}})},this._renderTitle=()=>{const{conversationTitle:e,hasNewMessages:a,isHighlighted:n}=this.props,t=e||i.a.createElement(z.b,null,te);return i.a.createElement(B.a,{style:ue.titleContainer},i.a.createElement(B.a,{style:[ue.titleTextRoot,n&&a?ue.titleTextHighlighted:null]},t),a?i.a.createElement(B.a,{style:ue.newMessageDotContainer},i.a.createElement(ne.a,{accessibilityLabel:oe,style:[ue.newMessageDotRoot,n?ue.newMessageDotHighlighted:ue.newMessageDotRegular]})):null)}}componentDidUpdate(e){const{hasNewMessages:a,isHighlighted:n,triggerHighlight:t}=this.props;e.isHighlighted||n||e.hasNewMessages||!a||t&&t()}render(){const{conversationSubtitle:e,conversationTitle:a,hasNewMessages:n,isHighlighted:t}=this.props,l=n?t?[ue.headerHighlighted]:[ue.headerActive]:[],s=this._isExpanded();return i.a.createElement(H.a,{enabled:!0,handlers:{[N.e.goLists]:U.a,[N.e.toggleDMDrawer]:this._handleToggleVisibilityKeyboard}},i.a.createElement(B.a,{ref:this._headerBar,style:[ue.headerRoot,!s&&ue.headerBorderClosed,...l,ue.cursor]},i.a.createElement(q.a,{leftControl:a&&this._isExpanded()?this._renderLeftControl():null,onMiddleControlClick:this._handleToggleVisibility,rightControl:this._renderRightControl(),style:ue.roundedAppBarCorners,subtitle:e,title:this._renderTitle(),withBackground:!t})))}}de.contextType=G.a;const ue=Q.a.create((e=>({root:{alignSelf:"flex-end",backgroundColor:e.colors.navigationBackground,borderColor:e.colors.borderColor,borderWidth:e.borderWidths.small,marginRight:e.spaces.space20,width:r.a.columnWidths.secondary.normal},cursor:{cursor:"pointer"},expanded:{height:r.a.columnWidths.secondary.normal},headerRoot:{borderTopLeftRadius:e.borderRadii.xLarge,borderTopRightRadius:e.borderRadii.xLarge,transition:"all 0.3s ease"},headerBorderClosed:{borderColor:e.colors.navigationBackground},headerActive:{backgroundColor:e.colors.unreadCellBackground},headerHighlighted:{borderColor:e.colors.primary,backgroundColor:e.colors.primary},titleContainer:{alignItems:"center",display:"flex",flexDirection:"row",flexGrow:1},titleTextRoot:{flexGrow:1,flexShrink:1},titleTextHighlighted:{color:e.colors.white},roundedAppBarCorners:{borderTopLeftRadius:e.borderRadii.xLarge,borderTopRightRadius:e.borderRadii.xLarge},newMessageDotContainer:{flexGrow:1},newMessageDotRoot:{width:e.spaces.space12,height:e.spaces.space12,marginLeft:e.spaces.space4},newMessageDotRegular:{color:e.colors.primary},newMessageDotHighlighted:{color:e.colors.white},newMessagePip:{right:e.spaces.space4,top:e.spaces.space4},rightControls:{flexDirection:"row"}})));var he=R(de),pe=n("zb92");var me=Object(pe.a)({loader:()=>Promise.all([n.e(0),n.e(234)]).then(n.bind(null,"Rk1B"))}),ge=n("aWzz"),ye=n("XnpN"),be=n("GSsg"),_e=n("aITJ"),ve=n("yrzJ");class ke extends i.a.Component{constructor(e,a){super(e,a),this._composer=i.a.createRef(),this._renderConversation=(e,a)=>{const{conversationId:n,history:t,location:l}=this.props;return i.a.createElement(M.a,{conversationId:n,drawerHeader:this._renderHeader(),history:t,isWide:!1,location:l,richTextInputContext:e,typeaheadWrapper:a})},this._isExpanded=()=>{const{visibility:e}=this.props;return e===O.b.EXPANDED},this._fetchUpdatesIfNeeded=()=>{const{conversationId:e,createLocalApiErrorHandler:a,fetchUpdatesIfNeeded:n,isDmReceiptSettingEnabled:t}=this.props;n(t?{active_conversation_id:e,dm_users:!0}:{}).catch(a())},Object(K.a)()}componentDidMount(){this._updatePolling()}componentDidUpdate(e){e.visibility!==this.props.visibility&&this._updatePolling()}render(){const e=this._isExpanded();return i.a.createElement(i.a.Fragment,null,!e&&this._renderHeader(),e?_e.b.isDesktopOS()?i.a.createElement(me,null,(({richTextInputContext:e,typeaheadWrapper:a})=>this._renderConversation(e,a))):this._renderConversation():null)}_renderHeader(){const{conversation:e,history:a,inboxUnreadCount:n,isHeaderHighlighted:t,isUnread:l,onDrawerOpen:s,perspective:r,triggerHeaderHighlight:o}=this.props,c=t?"white":"text",d=t?"white":"gray700",u=e&&e.type===L.a.ONE_TO_ONE&&r&&Object(ye.a)(e,r).map((({user:e})=>e.screen_name)),h=u?i.a.createElement(ve.a,{color:d,screenName:u[0]}):void 0;return i.a.createElement(B.a,{style:Ee.headerRoot},i.a.createElement(he,{conversationSubtitle:h,conversationTitle:i.a.createElement(D.b,{conversation:e,perspective:r,textColor:c,withScreenName:!1}),hasNewMessages:l,history:a,inboxUnreadCount:n,isHighlighted:t,onDrawerOpen:s,triggerHighlight:o}))}_updatePolling(){this._pollingTimer&&this._pollingTimer.stop(),this.props.visibility===O.b.COLLAPSED&&(this._pollingTimer=new be.a(this._fetchUpdatesIfNeeded,{interval:3e3}),this._pollingTimer.start())}getChildContext(){return{getCustomLocation:null}}}ke.contextType=G.a,ke.childContextTypes={getCustomLocation:ge.func};const Ee=Q.a.create((e=>({headerRoot:{position:"sticky",top:0,zIndex:e.componentZIndices.appBarZIndex}})));var fe=w(ke),Se=n("4q8G"),Ie=n("tn7R");var Ce=Object(d.a)().propsFromState((()=>({conversations:o.selectConversations,settings:f.g,unreadCount:k.a,untrustedConversationCount:o.selectUntrustedConversationCount,untrustedUnreadCount:o.selectUntrustedUnreadCount,visibility:o.selectDrawerVisibility}))).adjustStateProps((({conversations:e,settings:a,unreadCount:n,untrustedConversationCount:t,untrustedUnreadCount:l,visibility:s})=>{const i=[];for(const a of Object(Ie.a)(e)){var r;!a.isDeleted&&null!=(r=a.data)&&r.trusted&&i.push(a.data)}i.sort(Se.a);const o=n>0;return{allowUntrustedInbox:"all"===a.allow_dms_from||t>0,conversationIds:i.map((e=>e.conversation_id)),isUnread:o,untrustedUnreadCount:l,visibility:s}})).propsFromActions((()=>({createLocalApiErrorHandler:Object(u.createLocalApiErrorHandlerWithContextFactory)("DIRECT_MESSAGES_INBOX"),fetchInbox:o.fetchInbox,fetchInboxHistory:o.fetchTrustedInboxHistory,fetchInboxIfNeeded:o.fetchInboxIfNeeded,fetchUpdates:o.fetchUpdatesIfNeeded,updateLastSeenEventId:o.updateTrustedLastSeenEventId,popOutConversation:o.popOutConversation}))).withAnalytics({page:"messages",section:"inbox_drawer"}),Fe=n("cFyg"),xe=n("pXKu"),Te=n("nySH"),we=n("yw4N"),Le=n("FIs5"),Ke=n("csss");const Me=A.a.a2f8105f,De=A.a.b8aa3744,Re=A.a.j06309e1,Oe=A.a.gee5150a,Pe=A.a.cf2d1047,Ae=A.a.da2f9224,Ne=A.a.h6beb5fa;class He extends i.a.Component{constructor(...e){super(...e),this._renderHeader=()=>{const{history:e,isHeaderHighlighted:a,isUnread:n,onDrawerOpen:t,triggerHeaderHighlight:l}=this.props;return i.a.createElement(B.a,{style:Ue.headerRoot},i.a.createElement(he,{hasNewMessages:n,history:e,isHighlighted:a,onDrawerOpen:t,triggerHighlight:l}))},this._renderExpandedInbox=()=>{const{analytics:e,conversationIds:a,fetchInboxHistory:n,updateLastSeenEventId:t}=this.props;return i.a.createElement(B.a,{style:Ue.fill},i.a.createElement(B.a,{style:[Ue.viewportView,Fe.b.drawerHeaderRadius]},i.a.createElement(we.a,{style:[Ue.viewportView,Fe.b.drawerHeaderRadius]},this._renderHeader(),i.a.createElement(xe.a,{accessibilityTitle:Me,analytics:e,conversationIds:a,customCellClick:this._dmDrawerOnClick,fetchInboxHistory:n,isDrawer:!0,renderEmptyDMInbox:this._renderEmptyDMInbox,renderStickyContent:this._renderPivot,updateLastSeenEventId:t,virtualScrollerCacheKey:"dmDrawerInbox",withPinnedInbox:!0}))))},this._renderEmptyDMInbox=()=>i.a.createElement(i.a.Fragment,null,this._renderPivot(),i.a.createElement(Le.a,{buttonLink:"/messages/compose",buttonText:Oe,header:De,message:Re,onImpression:this._handleEmptyDMInboxImpression})),this._isExpanded=()=>{const{visibility:e}=this.props;return e===O.b.EXPANDED},this._dmDrawerOnClick=(e,a)=>{const{popOutConversation:n}=this.props;n(a),e.preventDefault()},this._handleEmptyDMInboxImpression=()=>{const{analytics:e}=this.props;e.scribe({component:"empty_message",action:"impression"})},this._handleRequestsPivotClick=()=>{const{analytics:e}=this.props;e.scribe({element:"requests_pivot",action:"click"})},this._renderPivot=()=>{const{allowUntrustedInbox:e}=this.props;return e?i.a.createElement(B.a,{style:Ue.requestPivotContainer},i.a.createElement(Ke.a,{label:Pe,link:Object(Te.a)(O.d.SECONDARY),onPress:this._handleRequestsPivotClick,renderRightContent:this._renderPivotBadge})):null},this._renderPivotBadge=()=>{const{untrustedUnreadCount:e}=this.props;return e>0?i.a.createElement(V.a,{count:e,standalone:!0,truncatedCountFormatter:Ne,unreadCountLabel:Ae}):null}}componentDidUpdate(){this._isExpanded()&&Object(K.a)()}render(){const e=this._isExpanded();return i.a.createElement(i.a.Fragment,null,!e&&this._renderHeader(),e&&this._renderExpandedInbox())}}He.contextType=G.a;const Ue=Q.a.create((e=>({fill:{flex:1,alignSelf:"stretch"},headerRoot:{position:"sticky",top:0,zIndex:e.componentZIndices.appBarZIndex},requestPivotContainer:{backgroundColor:e.colors.cellBackground,borderBottomStyle:"solid",borderBottomWidth:e.borderWidths.small,borderBottomColor:e.colors.borderColor,zIndex:2},viewportView:{...Q.a.absoluteFillObject,overflowY:"auto"}})));var Be=Ce(He),je=n("YeIG"),Ve=n("A69o"),ze="DMDrawer",qe=n("TnY3"),Qe=n("0FVZ"),Ge=n("Oe3h"),We=n("nBUg");const $e={isGlobal:!0,isSticky:!0},Ye={isGlobal:!0,isSticky:!1};class Xe extends i.a.PureComponent{constructor(...e){super(...e),this.state={isHeaderHighlighted:!1,hasStartedInitialFetch:!1,unexpandedHeight:void 0},this._handleLayout=e=>{const{nativeEvent:{layout:{height:a}}}=e,{unexpandedHeight:n}=this.state;this._isExpanded()||void 0!==n||this.setState({unexpandedHeight:a})},this._showDMDrawer=()=>{const{conversations:e,visibility:a}=this.props,n=a===O.b.CLOSED;return!this._isHideDMDrawerPath()&&!Object(je.a)(e)&&!n},this._isExpanded=()=>{const{visibility:e}=this.props;return e===O.b.EXPANDED},this._triggerHeaderHighlight=()=>{const{isHeaderHighlighted:e}=this.state;this._isExpanded()||e||this._headerHighlightTimeoutId||(this.setState({isHeaderHighlighted:!0}),this._headerHighlightTimeoutId=setTimeout((()=>{this.setState({isHeaderHighlighted:!1}),this._headerHighlightTimeoutId=void 0}),3e3))},this._handleDrawerOpen=()=>{const{isHeaderHighlighted:e}=this.state;e&&(this.setState({isHeaderHighlighted:!1}),clearTimeout(this._headerHighlightTimeoutId),this._headerHighlightTimeoutId=void 0)},this._isOnOcfFlow=()=>{const{location:e}=this.props;return e.pathname.startsWith("/i/flow")},this._isOnBirdwatchPage=()=>{const{location:e}=this.props;return e.pathname.startsWith("/i/birdwatch")},this._isHideDMDrawerPath=()=>this._isOnOcfFlow()||this._isOnBirdwatchPage()}componentWillUnmount(){clearTimeout(this._headerHighlightTimeoutId)}componentDidUpdate(){this._loadInboxDataIfNeeded()}componentDidMount(){this._loadInboxDataIfNeeded()}render(){const{history:e,location:a,perspective:n,poppedOutConversationId:t,width:s}=this.props,{isHeaderHighlighted:r,unexpandedHeight:o}=this.state,c=this._isExpanded();return this._showDMDrawer()?i.a.createElement(Qe.a.Drawer,null,i.a.createElement(Ge.a,{id:"DMDrawer"},((d,u)=>i.a.createElement(p.a.Provider,{value:{isDrawer:!0}},i.a.createElement(We.b.Provider,{value:{isDMDrawer:()=>!0}},i.a.createElement(B.a,l()({ref:d()},u({style:[Fe.b.root,{width:s}],testID:ze})),i.a.createElement(B.a,{onLayout:o?void 0:this._handleLayout,style:[Fe.b.expandable,{height:o,maxHeight:o},c&&Fe.b.expanded]},t?i.a.createElement(Ve.a.Provider,{value:Ye},i.a.createElement(fe,{conversationId:t,history:e,isHeaderHighlighted:r,location:a,onDrawerOpen:this._handleDrawerOpen,perspective:n,triggerHeaderHighlight:this._triggerHeaderHighlight})):i.a.createElement(Ve.a.Provider,{value:$e},i.a.createElement(Be,{history:e,isHeaderHighlighted:r,onDrawerOpen:this._handleDrawerOpen,triggerHeaderHighlight:this._triggerHeaderHighlight}))))))))):null}_loadInboxDataIfNeeded(){const{createLocalApiErrorHandler:e,fetchInboxIfNeeded:a,loadDrawerVisibilityFromPersistence:n}=this.props,{hasStartedInitialFetch:t}=this.state;this._isHideDMDrawerPath()||t||(n(),a().catch(e()),this.setState({hasStartedInitialFetch:!0}))}}Xe.defaultProps={width:r.a.dmDrawerWidth.max};const Ze=h(Xe);a.default=Object(qe.a)(Ze)},kb9v:function(e,a,n){"use strict";n("kYxP");var t=n("ERkP"),l=n.n(t),s=n("TIdA"),i=n("t62R"),r=n("A91F"),o=n("/yvb"),c=n("Eqye"),d=n("efqG"),u=n("sgih"),h=n("rHpw"),p=n("MWbm"),m=n("3dyc");const g=h.a.create((e=>({root:{paddingVertical:e.spacesPx.space32},rootWithImage:{paddingTop:0},graphic:{marginBottom:e.spacesPx.space20},icon:{alignSelf:"center",height:e.spacesPx.space64,width:e.spacesPx.space64},container:{paddingHorizontal:e.spacesPx.space32},description:{marginTop:e.spacesPx.space8,marginBottom:e.spacesPx.space4},actionButton:{marginTop:e.spacesPx.space16}})));a.a=({actionPrimary:e,actionSecondary:a,children:n,headline:t,icon:y,iconColor:b,imageUrl:_,onDismiss:v,shouldDisplay:k,text:E,withMask:f=!0})=>{const[S,I]=l.a.useState(!1),C=e=>l.a.createElement(d.a,{onDismiss:M,renderContent:()=>x(M),switchOnlyOnXSmallBreakpoint:!0,visibilityBehavior:m.b.forceVisible,withArrow:!0,withFixedPosition:!0,withMask:f},e),F=()=>l.a.createElement(u.a,{onMaskClick:()=>M(),type:"center",withMask:!0},x(M)),x=n=>l.a.createElement(p.a,{style:[g.root,_&&g.rootWithImage]},T(),l.a.createElement(p.a,{style:g.container},w(),L(),K({action:e,dismiss:n,type:a&&"primaryFilled"}),K({action:a,dismiss:n}))),T=()=>{let e=y&&l.a.createElement(y,{style:b?[g.icon,{color:h.a.theme.colors[b]}]:g.icon});return _&&!c.a.isEnabled&&(e=l.a.createElement(s.a,{accessibilityLabel:"",aspectMode:r.a.exact(2),image:_})),e&&l.a.createElement(p.a,{style:g.graphic},e)},w=()=>l.a.createElement(i.b,{size:"title3",weight:"heavy"},t),L=()=>l.a.createElement(i.b,{color:"gray700",style:g.description},E),K=({action:e,dismiss:a,type:n})=>e&&l.a.createElement(o.a,{link:e.link&&e.link,onPress:e.onClick?e.onClick:a,size:"large",style:g.actionButton,type:n},e.text),M=()=>{v&&v(),I(!0)};return k&&!S?n?C(n):F():n||null}},lBmi:function(e,a,n){"use strict";var t=n("ERkP"),l=n.n(t),s=n("Lsrn"),i=n("k/Ka");const r=(e={})=>Object(i.a)("svg",{...e,accessibilityHidden:void 0===e.accessibilityLabel,style:[s.a.root,e.style],viewBox:"0 0 24 24"},l.a.createElement("g",null,l.a.createElement("path",{d:"M23.885 19.5c-.762-3.064-3.72-5.206-7.19-5.206-1.17 0-2.27.265-3.258.707 1.246 1.08 2.157 2.5 2.564 4.138.252 1.004.052 2.03-.52 2.86h6.48c.627 0 1.2-.27 1.57-.744.38-.49.51-1.13.355-1.753zm-9.695 1.755c.38-.49.512-1.13.356-1.754-.375-1.506-1.284-2.785-2.52-3.7-1.278-.95-2.905-1.507-4.67-1.507-3.47 0-6.428 2.142-7.19 5.208-.156.626-.025 1.266.356 1.755.37.473.94.744 1.567.744h10.533c.627 0 1.197-.272 1.567-.745zm2.505-8.218c1.185 0 2.51-.132 3.368-1.11.72-.823.952-2.08.715-3.847-.333-2.478-1.86-3.956-4.083-3.956-2.225 0-3.75 1.48-4.084 3.956-.235 1.766 0 3.023.718 3.846.858.98 2.184 1.11 3.368 1.11zm-9.34 0c1.185 0 2.51-.132 3.367-1.11.72-.823.953-2.08.716-3.847-.333-2.478-1.86-3.956-4.083-3.956-2.225 0-3.75 1.48-4.084 3.956-.235 1.766 0 3.023.718 3.846.858.98 2.184 1.11 3.368 1.11z"})));r.metadata={width:24,height:24},a.a=r},nySH:function(e,a,n){"use strict";n.d(a,"a",(function(){return m})),n.d(a,"b",(function(){return g})),n.d(a,"c",(function(){return y}));var t=n("ERkP"),l=n.n(t),s=n("HPNB"),i=n("v6aA"),r=n("jYSG"),o=n("AQ79"),c=n("+Bsv"),d=n("MWbm"),u=n("cHvH"),h=n("t62R"),p=n("rHpw");const m=e=>{switch(e){case o.d.SECONDARY:return"/messages/requests";case o.d.TERTIARY:return"/messages/requests/additional";case o.d.PRIMARY:default:return"/messages"}},g=(e,a)=>l.a.createElement(i.a.Consumer,null,(({featureSwitches:n})=>{const t=n.isTrue("responsive_web_settings_revamp_enabled")?e:"/settings/safety";return l.a.createElement(c.a,{pullRight:a,to:t})})),y=e=>l.a.createElement(u.a,null,(({windowWidth:a})=>{const n=s.a.isTwoColumnLayout(a),t=0===e.length;return n||t?null:l.a.createElement(d.a,{style:b.stickyCopyContainer},l.a.createElement(h.b,{style:b.stickyCopy},r.a))})),b=p.a.create((e=>({stickyCopyContainer:{backgroundColor:e.colors.cellBackground,borderBottomStyle:"solid",borderBottomWidth:e.borderWidths.small,borderBottomColor:e.colors.borderColor,zIndex:1},stickyCopy:{color:e.colors.gray700,padding:e.spaces.space20}})))},pXKu:function(e,a,n){"use strict";n("kYxP");var t=n("ERkP"),l=n.n(t),s=n("BUB3"),i=n("v6aA"),r=n("xZGM"),o=n("rxPX");var c=Object(o.a)().propsFromState((()=>({shouldShowPrompt:(e,a)=>Object(r.D)(e,r.k)}))).propsFromActions((()=>({addFlag:r.z}))).withAnalytics({component:"dm_education_flags_prompt"}),d=n("fs1G"),u=n("t62R"),h=n("feu+"),p=n("3XMw"),m=n.n(p);const g=m.a.fd6150fc,y=l.a.createElement(m.a.I18NFormatMessage,{$i18n:"iac7f92a"},l.a.createElement(u.b,{link:"/privacy"},m.a.d42d239f)),b=m.a.j24c37b2;var _=c((e=>{const{addFlag:a,analytics:n,shouldShowPrompt:t}=e,{featureSwitches:s}=l.a.useContext(i.a);if(!(t&&s.isTrue("dm_education_flags_prompt")))return!1;return n.scribeAction("impression"),l.a.createElement(h.a,{actionLabel:b,headline:g,onAction:()=>{n.scribeAction("click"),a(r.k)},onClose:d.a,subtext:y,withCloseButton:!1})})),v=n("MMRb"),k=n("kGix"),E=n("0KEI");var f=Object(o.a)().propsFromState((()=>({hasConversations:v.selectHasConversations,fetchStatus:v.selectFetchStatus,isLoadingTop:v.selectIsLoadingTop}))).adjustStateProps((({fetchStatus:e,hasConversations:a,isLoadingTop:n})=>({fetchStatus:a?k.a.LOADED:e,isRefreshing:a&&n}))).propsFromActions((()=>({createLocalApiErrorHandler:Object(E.createLocalApiErrorHandlerWithContextFactory)("DIRECT_MESSAGES_INBOX"),fetchInbox:v.fetchInbox,fetchInboxIfNeeded:v.fetchInboxIfNeeded,fetchUpdates:v.fetchUpdatesIfNeeded}))),S=(n("MvUL"),n("HPNB")),I=n("EbOo"),C=n("tZH3"),F=n("1YZw"),x=n("hqKg"),T=n("AQOc"),w=n("G6rE"),L=n("oEGd");const K=(e,a)=>a.conversationId,M=Object(x.createSelector)(K,((e,a)=>v.selectConversation(e,K(0,a))),v.selectEntries,w.e.selectAll,((e,a)=>!v.selectConversationIsRead(e,K(0,a))),((e,a)=>{const n=K(0,a);return Object(v.selectInboxTypeByConversation)(e,n)}),((e,a)=>Object(r.D)(e,r.t)),((e,a,n,t,l,s,i)=>({conversation:(null==a?void 0:a.data)&&Object(T.a)(a.data,n,t),conversationId:e,unread:l,inboxType:s,shouldShowPinnedEducation:i}))),D={addFlag:r.z,addRecentSearch:v.addRecentSearches,addToast:F.b,block:w.e.block,createLocalApiErrorHandler:Object(E.createLocalApiErrorHandlerWithContextFactory)("DIRECT_MESSAGES_INBOX_ITEM"),disableNotifications:v.disableNotifications,enableNotifications:v.enableNotifications,leaveConversation:v.leaveConversation,muteDMUser:v.muteDMUser,unmuteDMUser:v.unmuteDMUser,unblock:w.e.unblock};var R=Object(L.f)(M,D),O=n("aA19"),P=n("OhSZ"),A=n("V/6K"),N=n("fQBn"),H=n("Myq3"),U=n("3wZR"),B=n("XnpN"),j=n("aWyx"),V=n("YemM"),z="conversation",q=n("u0B7"),Q=n("MWbm"),G=n("Irs7"),W=n("eb3s"),$=n("ZToW"),Y=n("cHvH"),X=n("lHOd"),Z=n("kb9v"),J=n("IG7M"),ee=n("mjJ+"),ae=n("Znyr"),ne=n("0PHd"),te=n("yrzJ"),le=n("Xrkv"),se=n("efqG"),ie=n("/yvb"),re=n("GBcw"),oe=n("cm6r"),ce=n("htQn"),de=n("5mJL"),ue=n("vMjK"),he=n("AQ79"),pe=n("pHkl"),me=n("X/yg"),ge=n("Lsrn"),ye=n("k/Ka");const be=(e={})=>Object(ye.a)("svg",{...e,accessibilityHidden:void 0===e.accessibilityLabel,style:[ge.a.root,e.style],viewBox:"0 0 24 24"},l.a.createElement("g",null,l.a.createElement("path",{d:"M17.931 2.508c0 .42-.34.75-.75.75h-8.39l1.38 2.08-.56 5.78-.47.16c-1.5.49-3.1 2.07-3.37 3.31-.07.35-.39.59-.73.59-.05 0-.11 0-.16-.01-.4-.09-.66-.49-.58-.89.39-1.81 2.24-3.52 3.91-4.25l.42-4.3-1.35-2.02c-.26-.38-.29-.87-.07-1.29.24-.41.66-.66 1.11-.66h8.86c.41 0 .75.34.75.75zm3.09 12.76c-.14.17-.46.46-1.05.46h-3.86l-2.64 6.1c-.12.28-.39.45-.69.45s-.57-.17-.69-.45l-1.96-4.53c-.16-.38.01-.82.39-.98.38-.17.82.01.99.39l1.27 2.93 1.69-3.91h-1.61c-.42 0-.75-.33-.75-.75 0-.41.33-.75.75-.75h6.81c-.41-1.06-1.64-2.26-2.91-2.82-.09-.04-.16-.09-.22-.16-.22-.21-.3-.54-.17-.83.17-.38.61-.55.99-.39 1.59.7 3.5 2.43 3.89 4.25.06.25.03.66-.23.99zm.839-12.259L3.2 21.659c-.15.15-.34.22-.53.22s-.39-.07-.53-.22c-.29-.29-.29-.76 0-1.06L20.8 1.939c.29-.29.76-.29 1.06 0 .29.3.29.77 0 1.07z"})));be.metadata={width:24,height:24};var _e=be,ve=n("ShJ/");const ke=(e={})=>Object(ye.a)("svg",{...e,accessibilityHidden:void 0===e.accessibilityLabel,style:[ge.a.root,e.style],viewBox:"0 0 32 32"},l.a.createElement("g",null,l.a.createElement("path",{d:"M28.05 6.52h-5.42V4.887c0-1.548-1.26-2.808-2.81-2.808h-7.54c-1.548 0-2.807 1.26-2.807 2.808v1.63H4.05c-.414 0-.75.337-.75.75s.336.75.75.75h.753L7 26.435c.27 1.504 1.657 2.554 3.37 2.554h11.36c1.713 0 3.1-1.05 3.376-2.598l2.19-18.37h.753c.413 0 .75-.337.75-.75s-.336-.75-.75-.75zM10.972 4.887c0-.72.586-1.308 1.307-1.308h7.542c.72 0 1.308.587 1.308 1.308v1.63H10.972V4.89zm12.65 21.28c-.163.91-1.068 1.32-1.893 1.32H10.37c-.824 0-1.73-.41-1.887-1.276L6.313 8.02h19.472l-2.162 18.148z"}),l.a.createElement("path",{d:"M13.312 23.123c.414 0 .75-.336.75-.75v-9.6c0-.414-.336-.75-.75-.75s-.75.336-.75.75v9.6c0 .414.336.75.75.75zm5.486 0c.414 0 .75-.336.75-.75v-9.6c0-.414-.336-.75-.75-.75s-.75.336-.75.75v9.6c0 .414.336.75.75.75z"})));ke.metadata={width:32,height:32};var Ee=ke,fe=n("zIWA"),Se=n("5pef"),Ie=n("IpT4"),Ce=n("5oT/"),Fe=n("fz3c");const xe=m.a.d88d0790,Te=m.a.ad63377d,we={confirmButtonLabel:m.a.bb1d57b6,actionTextLeave:m.a.g9074da4,header:m.a.gdf4b79f,text:m.a.h09b49f7},Le=m.a.e1c9ec9b,Ke=m.a.i6b19b07,Me=m.a.e3cfff7c,De=m.a.f398722d,Re=m.a.a8ed0eca,Oe=m.a.jac4eb1e,Pe=m.a.bdd91963,Ae=m.a.a30a206d,Ne=m.a.ib4b1b85,He=m.a.bd3ca2ee,Ue=e=>{var a;return Boolean(null==e||null==(a=e.labels)?void 0:a.find((e=>e.label_type===he.a.PINNED)))},Be={component:"low_quality_timeline"},je=({children:e})=>l.a.createElement(Q.a,{style:V.a.socialProofContainer},e);class Ve extends l.a.Component{constructor(...e){super(...e),this._count=this.context.featureSwitches.getValue("dm_conversation_labels_max_pinned_count"),this._isPinnedEducationEnabled=this.context.featureSwitches.isTrue("dm_conversation_labels_pinned_education_enabled"),this._isPinnedInboxEnabled=this.context.featureSwitches.isTrue("dm_conversation_labels_pinned_enabled")&&this.context.featureSwitches.isTrue("direct_messages_incremental_holdback_2022h1"),this._isVDLEnabled=this.context.featureSwitches.isTrue("dm_vdl_enabled")&&this.context.featureSwitches.isTrue("dm_vdl_inbox_p0_enabled"),this.state={showActionMenu:!1,showConfirmation:!1,showPinnedAnnouncement:!1},this._renderConfirmationSheet=()=>{const{conversationId:e}=this.props;return l.a.createElement(W.a,{confirmButtonLabel:we.confirmButtonLabel,confirmButtonType:"destructiveFilled",headline:we.header,onCancel:this._handleHideConfirmation,onConfirm:this._deleteConversation(e),text:we.text})},this._renderMenu=({isFocused:e,isFocusedWithin:a,isHovered:n})=>{const{showActionMenu:t,showPinnedAnnouncement:s}=this.state,{conversation:i,position:r}=this.props,o=Ue(i),c=()=>{this.setState({showPinnedAnnouncement:!1})},d=()=>{this.setState({showActionMenu:!0})},u=this._isPinnedEducationEnabled&&s&&1===r&&!o,h=!$.a.isEnabled||e||a||n||t||u;return l.a.createElement(A.a.Consumer,null,(({isDrawer:e})=>l.a.createElement(Y.a,null,(({windowWidth:a})=>{const n=S.a.isTwoColumnLayout(a);return l.a.createElement(X.a.Consumer,null,(a=>l.a.createElement(Q.a,{style:V.a.menuContainer},l.a.createElement(Z.a,{actionPrimary:{text:Ae,onClick:c},headline:Ne,onDismiss:c,shouldDisplay:u&&!e,text:He({count:this._count}),withMask:!n},n?l.a.createElement(J.a,{onClick:d,renderActionMenu:this._renderActionMenu,style:h?V.a.menu:V.a.hiddenMenu}):null),n?null:l.a.createElement(J.a,{onClick:d,renderActionMenu:this._renderActionMenu,style:h?V.a.menu:V.a.hiddenMenu}))))}))))},this._renderActionMenu=e=>{const{conversation:a,conversationId:n}=this.props,{history:t}=this.context,s=Ue(a),i=null==a?void 0:a.notifications_disabled,r=[];if(a){const e={Icon:s?_e:ve.a,onClick:()=>this._handleTogglePinState(s),text:s?Pe:Le,withBottomBorder:!0};r.push(e);const a={Icon:Ee,isEmphasized:!0,onClick:this._handleDeleteMenuItemClick,text:Te,withBottomBorder:!0},l={Icon:fe.a,onClick:()=>this._handleReportMenuItemClick(t)(),text:Ke,withBottomBorder:!0},o={Icon:i?Se.a:Ie.a,onClick:()=>this._handleSnoozeMenuItemClick(n),text:i?Re:Me,withBottomBorder:!0};r.push(l,o,a)}return l.a.createElement(ee.a,{items:r,onCloseRequested:this._handleHideMenu(e),shouldCloseOnClick:!0})},this._renderConversationActions=({isFocused:e,isFocusedWithin:a,isHovered:n})=>{const{inboxType:t}=this.props;switch(t){case he.d.PRIMARY:return this._isPinnedInboxEnabled?this._renderMenu({isFocused:e,isFocusedWithin:a,isHovered:n}):null;case he.d.SECONDARY:case he.d.TERTIARY:return this._renderX();default:return null}},this._renderConversationEndCell=e=>{const{inboxType:a,searchQuery:n,unread:t}=this.props,s=t?l.a.createElement(ae.a,{pip:!0,style:V.a.unreadMessagePip,truncatedCountFormatter:()=>"",unreadCountLabel:()=>""}):null;switch(a){case he.d.PRIMARY:return this._isVDLEnabled?s:n?null:this._renderTimestamp(e);case he.d.SECONDARY:return this._isVDLEnabled?s:null;default:return null}},this._renderConversationLabel=({convo_label:e})=>{if(null==e||!e.text)return null;const a=Object(U.b)(e.icon);return l.a.createElement(u.b,{color:"gray700",size:"subtext2"},a?l.a.createElement(a,{style:V.a.convoLabelIcon}):null,e.text)},this._renderSocialProof=({social_proof:e})=>{if(!e||0===e.length)return null;const a=e[0];switch(a.proof_type){case j.d.MUTUAL_FRIENDS:{if(0===a.total)return null;const e=a.users.map((({profile_image_url_https:e})=>e)),n=a.users.map((({name:e})=>e));return l.a.createElement(je,null,l.a.createElement(u.b,{weight:this._isVDLEnabled?"medium":"normal"},l.a.createElement(ne.a,{displayFacepileInline:!0,knownFollowersAvatarUrls:e,knownFollowersCount:a.total,knownFollowersNames:n,textStyle:this._isVDLEnabled&&V.a.socialProofText,withFacepile:!this._isVDLEnabled})))}default:return null}},this._renderSearchConversationPreview=()=>{const{conversation:e,perspective:a,searchQuery:n}=this.props,t=e?Object(B.a)(e,a):[],s=[],i=(e,a)=>e.localeCompare(a),r=t.map((({user:e})=>e)).filter((e=>{var t;const l=null==(t=e.name)?void 0:t.toLowerCase().includes(n);return e.id_str!==a&&(l&&s.push(e.name),!l)})).map((e=>e.name)).sort(i),o=s.sort(i).concat(r);if(e){if(e.type===v.CONVERSATION_TYPE.ONE_TO_ONE){const[e]=t.map((({user:e})=>e));return l.a.createElement(te.a,{color:"gray700",screenName:e.screen_name})}{const e=!0,a=Object(le.a)(o,e);return l.a.createElement(u.b,{color:"gray700",numberOfLines:2},a)}}},this._renderX=()=>{const{conversation:e,conversationId:a}=this.props,{loggedInUserId:n}=this.context,t=Object(me.j)(e,n),s=(null==e?void 0:e.type)===v.CONVERSATION_TYPE.GROUP;return l.a.createElement(X.a.Consumer,null,(e=>l.a.createElement(se.a,{renderContent:(n,i)=>l.a.createElement(C.a,{dismiss:n,flatBorders:"sheet"===i,isGroup:s,onBlockClick:this._blockUser(t.idStr),onDeleteClick:this._deleteConversation(a),onReportClick:this._handleReportMenuItemClick(e),requestorScreenName:t.screenName,showBlock:!s,showCancel:"sheet"===i,showDelete:!0})},l.a.createElement(ie.a,{accessibilityLabel:xe,icon:l.a.createElement(Ce.a,{style:this._isVDLEnabled?V.a.xIcon:void 0}),onPress:this._handleXPress,style:this._isVDLEnabled?V.a.vdlXButton:V.a.xButton,type:this._isVDLEnabled?void 0:"destructiveText"}))))},this._handleDeleteMenuItemClick=()=>{this.setState({showConfirmation:!0})},this._handleHideMenu=e=>()=>{e&&e(),this.setState({showActionMenu:!1})},this._getUserIdOfOneToOneConvo=()=>{const{conversation:e,perspective:a}=this.props,n=e&&Object(B.a)(e,a).map((({user:e})=>e)),t=n&&n[0]||null;return t?t.id_str:""},this._handleReportMenuItemClick=e=>()=>{const{analytics:a,conversation:n,conversationId:t,inboxType:l}=this.props,s=Fe.a.DMConversation,{featureSwitches:i}=this.context,r=(null==n?void 0:n.type)===v.CONVERSATION_TYPE.GROUP?"0":this._getUserIdOfOneToOneConvo();if(t)if(a.scribeAction("report"),Object(Fe.g)(i,s)){const n=Object(Fe.d)({clientReferer:window.location.pathname,isMedia:!1,isPromoted:!1,reportType:s,reportedConversationId:t,reportedUser:r,scribeNamespace:a.contextualScribeNamespace});e.push({pathname:"/i/safety/report_story_start",state:{input:{requested_variant:JSON.stringify(n)}}})}else{const n=Object(me.g)(t,window.location.pathname,a.contextualScribeNamespace,l);e.push(n)}},this._handleSnoozeMenuItemClick=e=>{const{addToast:a,analytics:n,conversation:t,disableNotifications:l,enableNotifications:s}=this.props;if(null==t?void 0:t.notifications_disabled)s({conversationId:e}).then(a({ariaOnly:!0,text:Oe}));else{const s=(null==t?void 0:t.participants.length)||0,i={conversation_type:(null==t?void 0:t.type)===v.CONVERSATION_TYPE.GROUP?pe.j.GROUP:pe.j.ONE_TO_ONE,conversation_id:e,conversation_participant_count:s,entry_point:pe.c.THREE_DOT_MENU};n.scribe({element:"thread",action:"mute_dm_thread_forever",data:i}),l({conversationId:e}).then(a({ariaOnly:!0,text:De}))}},this._handleTogglePinState=e=>{const{analytics:a,conversation:n,conversationId:t,pinConversation:l,position:s,unpinConversation:i}=this.props,r=e?"unpin_dm_conversation":"pin_dm_conversation",o=e?i:l,c=(null==n?void 0:n.participants.length)||0,d={conversation_type:(null==n?void 0:n.type)===v.CONVERSATION_TYPE.GROUP?pe.j.GROUP:pe.j.ONE_TO_ONE,conversation_id:t,conversation_participant_count:c,position:s};a.scribe({element:"thread",action:r,data:d}),n&&o&&o(t,n)},this._handleXPress=e=>{e.preventDefault()},this._renderTimestamp=e=>{const{conversation:a,isMessageItem:n}=this.props,t=this.context.featureSwitches.isTrue("dm_vdl_enabled")&&this.context.featureSwitches.isTrue("dm_vdl_inbox_p0_enabled"),s=[t||n?V.a.inlineNotificationsDisabledIcon:V.a.notificationsDisabledIcon,t&&V.a.inlineNotificationsDisabledIconVDL],i=Number(e&&n?null==e?void 0:e.time:null==a?void 0:a.sort_timestamp);return l.a.createElement(l.a.Fragment,null,l.a.createElement(Q.a,{style:[n&&V.a.inlineTimestamp,t&&V.a.inlineTimestampVDL]},a&&i?l.a.createElement(re.a,{timestamp:i}):null,null!=a&&a.notifications_disabled?l.a.createElement(Ie.a,{style:s}):null))},this._deleteConversation=e=>()=>{const{analytics:a,conversation:n,createLocalApiErrorHandler:t,inboxType:l,leaveConversation:s,position:i}=this.props,{history:r}=this.context,o=Ue(n),c=(null==n?void 0:n.participants.length)||0,d=n&&n.type===v.CONVERSATION_TYPE.GROUP?"leave_group":"delete_thread",u={conversation_type:(null==n?void 0:n.type)===v.CONVERSATION_TYPE.GROUP?pe.j.GROUP:pe.j.ONE_TO_ONE,conversation_id:e,conversation_participant_count:c,position:i,inbox_type:Object(me.i)(l),entry_point:l===pe.e.PRIMARY?pe.c.THREE_DOT_MENU:pe.c.CELL_X_BUTTON};this._handleHideConfirmation(),a.scribe({element:"thread",action:d,data:u}),o&&this._handleTogglePinState(o),s({conversationId:e}).catch(t({showToast:!0})),r.replace(Object(me.f)(l))},this._blockUser=e=>()=>{const{addToast:a,analytics:n,block:t,createLocalApiErrorHandler:l}=this.props;t(e).then((()=>{a({action:{label:ue.c,onAction:this._createUnblockUserHandler(e)},text:ue.a})}),l(I.a)),n.scribeAction("block")},this._createUnblockUserHandler=e=>()=>{const{analytics:a,createLocalApiErrorHandler:n,unblock:t}=this.props;t(e).catch(n(q.a)),a.scribeAction("unblock")},this._handleHideConfirmation=()=>{this.setState({showConfirmation:!1})},this._handleOnClick=e=>{const{addRecentSearch:a,analytics:n,conversation:t,conversationId:l,onClick:s,position:i,searchQuery:r}=this.props,o=(null==t?void 0:t.participants.length)||0,c=(null==t?void 0:t.type)===v.CONVERSATION_TYPE.GROUP;r&&(n.scribe({component:"search",element:"conversation",action:"click",data:{conversation_id:l,conversation_participant_count:o,conversation_type:c?pe.j.GROUP:pe.j.ONE_TO_ONE,entry_point:pe.c.ALL,inbox_type:pe.e.PRIMARY,dm_search_result_type:pe.a.CONVERSATION,message_type:pe.f.NOT_APPLICABLE,position:i}}),n.scribe({component:"recent_search",action:"add"}),a(r)),s(e,l,t,i)},this._handleShowConfirmation=e=>{const{analytics:a}=this.props;e.stopPropagation(),a.scribe({...Be,element:"accessory_trashcan",action:"click"}),this.setState({showConfirmation:!0})}}componentDidMount(){const{addFlag:e,shouldShowPinnedEducation:a}=this.props;a&&(this.setState({showPinnedAnnouncement:!0}),e(r.t))}shouldComponentUpdate(e,a){const n=this.props.conversation,t=null==n?void 0:n.conversation_id,l=null==n?void 0:n.notifications_disabled,s=null==n?void 0:n.last_read_event_id,i=null==n?void 0:n.sort_event_id,r=null==n?void 0:n.max_entry_id,o=null==n?void 0:n.convo_label,c=this.props.messageId,d=e.conversation,u=null==d?void 0:d.conversation_id,h=null==d?void 0:d.notifications_disabled,p=null==d?void 0:d.last_read_event_id,m=null==d?void 0:d.sort_event_id,g=null==d?void 0:d.max_entry_id,y=null==d?void 0:d.convo_label,b=e.messageId,{filter:_,isActive:v}=this.props,{filter:k,isActive:E}=e,{showConfirmation:f,showPinnedAnnouncement:S}=this.state,{showConfirmation:I,showPinnedAnnouncement:C}=a;return t!==u||l!==h||s!==p||i!==m||r!==g||c!==b||v!==E||f!==I||_!==k||o!==y||S!==C}render(){const{conversation:e,isActive:a,isMessageItem:n,link:t,messageId:s,perspective:i,position:r,searchQuery:o,unread:c}=this.props,{showConfirmation:d}=this.state,u=(null==e?void 0:e.entries)||[],h=n?u.find((e=>e.id===s)):Object(H.a)(u,(e=>!pe.b.includes(e.type))),p=[V.a.root,c&&!this._isVDLEnabled&&V.a.unread,a&&this._isVDLEnabled&&V.a.active],m=(null==e?void 0:e.type)===v.CONVERSATION_TYPE.GROUP,g=this._isVDLEnabled&&m;if(!e)return null;const y=!!e.convo_label,b=!e.trusted&&!y,_=this._renderConversationEndCell(h),k=o&&!n;let E="text",f="bold";return this._isVDLEnabled&&!c&&(E="gray900",f="medium"),this._isVDLEnabled&&a&&(E="text",f="medium"),!e||!o&&e.isSearchResultOnly?null:l.a.createElement(l.a.Fragment,null,d?this._renderConfirmationSheet():null,l.a.createElement(oe.a,null,(({isFocused:s,isFocusedWithin:d,isHovered:u})=>l.a.createElement(ce.a,{accessibilityRole:"none",accessibilityState:{selected:a},link:{pathname:null==t?void 0:t.pathname,anchorless:!0,state:{...null==t?void 0:t.state,position:r,entryPoint:n?null==h?void 0:h.id:null,isMessageItem:n}},onPress:this._handleOnClick,style:p,testID:z},l.a.createElement(de.a,{avatarCell:l.a.createElement(O.a,{conversation:e,perspective:i,withBadge:g}),avatarSize:"xxLarge"},l.a.createElement(Q.a,{style:V.a.bodyColumn},l.a.createElement(Q.a,{style:V.a.titleContainer},l.a.createElement(P.b,{conversation:e,isConversationSearchTitle:!!k,isMessageSearchTitle:!!n,perspective:i,renderTimestamp:()=>this._renderTimestamp(h),textColor:E,titleWeight:f,withScreenName:!o&&!n,withVDLRefresh:this._isVDLEnabled}),l.a.createElement(Q.a,{style:[V.a.snippet,!s&&!d&&!u&&V.a.snippetPadding]},h&&!k?l.a.createElement(N.a,{conversationType:e.type,entry:h,isMessageItem:n,isSelected:this._isVDLEnabled&&a,perspective:i,unread:this._isVDLEnabled&&c}):k?this._renderSearchConversationPreview():null),y?this._renderConversationLabel(e):null,b?this._renderSocialProof(e):null),_?l.a.createElement(Q.a,{style:V.a.endCell},_):null,this._renderConversationActions({isFocused:s,isFocusedWithin:d,isHovered:u})))))))}}Ve.contextType=i.a,Ve.defaultProps={searchQuery:"",inboxType:"primary",isActive:!1,filter:e=>!0};var ze=Object(G.a)(R(Ve),{page:"messages",section:"inbox"});var qe=Object(o.a)().propsFromState((()=>({pinnedConversationIds:v.selectPinnedConversationIds}))).propsFromActions((()=>({createLocalApiErrorHandler:Object(E.createLocalApiErrorHandlerWithContextFactory)("DM_PINNED_INBOX_CONTEXT")}))).withAnalytics({page:"messages",section:"inbox"}),Qe=n("oUUt"),Ge=n("d9IC"),We=n("h3MB");n("Qavd");const $e=(e,{module:a})=>a.selectItems(e),Ye=(e,{module:a})=>a.selectFetchStatus(e);var Xe=Object(o.a)().propsFromState((()=>({fetchStatus:Ye,sliceItems:$e}))).adjustStateProps((({fetchStatus:e,sliceItems:a})=>{const n=(e=>{var a;return(null==(a=e.find((e=>e.groupData)))?void 0:a.groupData)||[]})(a),t=(e=>{var a;return(null==(a=e.find((e=>e.peopleData)))?void 0:a.peopleData)||[]})(a),l=(e=>{var a,n;return(null==(a=e.find((e=>e.messageData)))||null==(n=a.messageData)?void 0:n.conversationIds)||[]})(a);return{entryIds:(e=>{var a,n;return(null==(a=e.find((e=>e.messageData)))||null==(n=a.messageData)?void 0:n.entryIds)||[]})(a),fetchStatus:e,groupConversationIds:n,messageConversationIds:l,peopleSearchConversationIds:t,sliceItems:a}})).propsFromActions((({module:e})=>({createLocalApiErrorHandler:Object(E.createLocalApiErrorHandlerWithContextFactory)("DM_SEARCH_ALL_CONTEXT"),fetchSearchIfNeeded:e.fetchIfNeeded}))),Ze=n("MDbM"),Je=n("v//M"),ea=n("0yYu"),aa=n("rHpw"),na=n("lBmi"),ta=n("91AQ"),la=n("6ZHn");const sa=m.a.c94ac69d,ia=m.a.a2f8105f,ra=m.a.g2fd3205,oa=m.a.ffd9cfe6;class ca extends l.a.Component{constructor(...e){super(...e),this._groupBucketSize=this.context.featureSwitches.getNumberValue("dm_inbox_search_groups_bucket_size"),this._messagesBucketSize=this.context.featureSwitches.getNumberValue("dm_inbox_search_messages_bucket_size"),this._peopleBucketSize=this.context.featureSwitches.getNumberValue("dm_inbox_search_people_bucket_size"),this._renderSearchResults=()=>{const{groupConversationIds:e,messageConversationIds:a,peopleSearchConversationIds:n,renderEmptyState:t}=this.props,s=n.length&&e.length,i=this._groupBucketSize<e.length,r=this._messagesBucketSize<a.length,o=this._peopleBucketSize<n.length;return(null==e?void 0:e.length)||n.length||a.length?l.a.createElement(l.a.Fragment,null,n.length?this._renderPeopleSection():null,s&&!o?l.a.createElement(ea.a,null):null,o?this._renderDMSearchFooter(ra):null,e.length?this._renderGroupsSection():null,i?this._renderDMSearchFooter(sa):null,a.length?this._renderMessagesSection():null,r?this._renderDMSearchFooter(ia):null):t()},this._handleFetch=()=>{const{createLocalApiErrorHandler:e,fetchSearchIfNeeded:a}=this.props;a().catch(e())},this._renderDMSearchFooter=e=>{const{location:a}=this.props;return l.a.createElement(Q.a,{style:da.header},l.a.createElement(u.b,{link:{pathname:a.pathname,state:{tab:e}}},oa))},this._renderDMHeader=({headerText:e,icon:a})=>l.a.createElement(Ge.a,{headerText:e,icon:a}),this._renderGroupsSection=()=>{const{groupConversationIds:e,pinConversation:a,renderInboxItem:n,unpinConversation:t}=this.props;return l.a.createElement(l.a.Fragment,null,this._renderDMHeader({icon:na.a,headerText:sa}),e.map((l=>l?n({conversationIds:e,pinConversation:a,unpinConversation:t})(l):null)).slice(0,this._groupBucketSize))},this._renderMessagesSection=()=>{const{entryIds:e,messageConversationIds:a,pinConversation:n,renderInboxItem:t,unpinConversation:s}=this.props;return l.a.createElement(l.a.Fragment,null,this._renderDMHeader({icon:ta.a,headerText:ia}),e.map((l=>l?(l=>t({conversationIds:a,isMessageItem:!0,messageIds:e,pinConversation:n,unpinConversation:s})(l))(l):null)).slice(0,this._messagesBucketSize))},this._renderPeopleSection=()=>{const{peopleSearchConversationIds:e,pinConversation:a,renderInboxItem:n,unpinConversation:t}=this.props;return l.a.createElement(l.a.Fragment,null,this._renderDMHeader({icon:la.a,headerText:ra}),e.map((l=>l?n({conversationIds:e,pinConversation:a,unpinConversation:t})(l):null)).slice(0,this._peopleBucketSize))}}componentDidUpdate(e){const{fetchStatus:a,module:n}=this.props;e.module!==n&&a!==Ze.a.FAILED&&this._handleFetch()}componentDidMount(){this._handleFetch()}render(){const{fetchStatus:e,loadingLabel:a}=this.props;return l.a.createElement(Je.a,{accessibilityLabel:a,fetchStatus:e,onRequestRetry:this._handleFetch,render:this._renderSearchResults})}}ca.contextType=i.a;const da=aa.a.create((e=>({header:{backgroundColor:e.colors.cellBackground,paddingLeft:e.spaces.space16,paddingVertical:e.spaces.space12,alignItems:"center",flexDirection:"row",justifyContent:"space-between",borderBottomStyle:"solid",borderBottomWidth:e.borderWidths.small,borderBottomColor:e.colors.borderColor,borderTopStyle:"solid",borderTopWidth:e.borderWidths.small,borderTopColor:e.colors.borderColor}})));var ua=Xe(ca),ha=n("wAC9"),pa=n("xPna");const ma=(e,a=!0)=>{const n={};let t={};return null!=e&&e.conversations&&(Object.values(e.conversations).forEach((e=>{e&&e.users&&Object.assign(n,e.users),a&&(e.isSearchResult=!0)})),t={conversations:null==e?void 0:e.conversations,users:n}),null!=e&&e.entries&&(t={...t,entries:null==e?void 0:e.entries}),Object(pa.a)(t)};var ga=e=>Object(ha.a)({contextSuffix:"DM_SEARCH_SLICE",getFetchApiEndpoint:e=>e.DirectMessagesGraphQL.fetchDMAllSearch,sliceKey:`${pe.h}-${e}`,getEndpointParams:a=>({...a,query:e}),mapEntitiesToActions:ma});const ya=(e,a)=>a.query;var ba=Object(o.a)().propsFromState((()=>({sliceModule:Object(x.createSelector)(ya,(e=>e?ga(e):void 0))})))((e=>{const{loadingLabel:a,location:n,pinConversation:t,query:s,renderEmptyState:i,renderInboxItem:r,sliceModule:o,unpinConversation:c}=e;return o?l.a.createElement(ua,{loadingLabel:a,location:n,module:o,pinConversation:t,query:s,renderEmptyState:i,renderInboxItem:r,unpinConversation:c}):i()}));const _a=v.selectRecentSearches,va=(e,a)=>a.query?v.selectSearchConversations(e,a.query):[],ka=(e,a)=>a.query?v.selectSearchFetchStatus(e,a.query):k.a.LOADED,Ea=(e,a)=>a.conversationIds||[],fa=(e,a)=>null!=e&&e.length?a.filter((a=>e.indexOf(a)>-1)):e;var Sa=Object(o.a)().propsFromState((()=>({conversationIds:Ea,recentSearches:_a,searchFetchStatus:ka,searchConversationIds:va}))).adjustStateProps((({conversationIds:e,recentSearches:a,searchConversationIds:n,searchFetchStatus:t})=>({conversationIds:e,recentSearches:a,searchFetchStatus:t,searchConversationIds:fa(n,e)}))).propsFromActions((()=>({addRecentSearch:v.addRecentSearches,createLocalApiErrorHandler:Object(E.createLocalApiErrorHandlerWithContextFactory)("DIRECT_MESSAGES_SEARCH"),search:v.searchConversations,clearRecentSearch:v.clearRecentSearch,clearRecentSearches:v.clearRecentSearches}))),Ia=n("VY6S"),Ca=n("s14A");var Fa=e=>Object(ha.a)({contextSuffix:"DM_GROUP_SEARCH_SLICE",getFetchApiEndpoint:e=>e.DirectMessagesGraphQL.fetchDMGroupSearch,sliceKey:`${pe.h}-groups-${e}`,getEndpointParams:a=>({...a,query:e}),mapEntitiesToActions:ma});var xa=e=>Object(ha.a)({contextSuffix:"DM_PEOPLE_SEARCH_SLICE",getFetchApiEndpoint:e=>e.DirectMessagesGraphQL.fetchDMPeopleSearch,sliceKey:`${pe.h}-people-${e}`,getEndpointParams:a=>({...a,query:e}),mapEntitiesToActions:ma});const Ta=(e,a)=>a.query,wa=(e,a)=>a.tabType;var La=Object(o.a)().propsFromState((()=>({sliceModule:Object(x.createSelector)(wa,Ta,((e,a)=>{const n=a&&e===pe.i.PEOPLE;return a&&e===pe.i.GROUPS?Fa(a):n?xa(a):void 0}))}))),Ka=n("FS1z");var Ma,Da=La((e=>{const{footer:a,onScrollEnd:n,pinConversation:t,renderEmptyState:s,renderInboxItem:i,sliceModule:r,unpinConversation:o}=e;return r?l.a.createElement(Ka.a,{footer:a,module:r,noItemsRenderer:s,onScrollEnd:n,renderer:i({conversationIds:[],pinConversation:t,unpinConversation:o}),withoutHeadroom:!0}):s()})),Ra=n("VPW4"),Oa=(n("enFi"),n("mN6z")),Pa=n("TEoO"),Aa=n("NjAB"),Na=n("Fr3L"),Ha=n("uDfI"),Ua=n("s8G+"),Ba=n("DQzJ");const ja=void 0!==Ma?Ma:Ma=n("y59G"),Va="DM_MESSAGE_SEARCH",za={context:Va},qa=e=>e,Qa=e=>{var a;const{footer:n,noItemsRenderer:t,onScrollEnd:s,pinConversation:i,renderInboxItem:r,searchTerm:o,unpinConversation:c}=e,d=Object(Ha.c)(),u=Object(Ua.a)("dm_inbox_search_message_attachment_previews_enabled"),h=Object(Ua.a)("rito_safety_mode_blocked_profile_enabled"),p=Object(Ua.a)("super_follow_user_api_enabled"),{data:m,fetchNext:g,hasNext:y}=Object(Ba.a)(ja,{query:o,withAttachments:u,withSafetyModeUserFields:h,withSuperFollowsUserFields:p}),{entities:b,normalizedConversations:_,normalizedMessages:v}=l.a.useMemo((()=>{var e,a,n;const t=null==m||null==(e=m.dm_message_slice_result)||null==(a=e.items)?void 0:a.map((e=>{var a,n;return null==e||null==(a=e.dm_event)||null==(n=a.legacy)?void 0:n.conversation})),l=null==m||null==(n=m.dm_message_slice_result)?void 0:n.items,s=Object(Aa.b)(t,[We.a]),i=Object(Aa.b)(l,[We.b]);return{normalizedConversations:s,normalizedMessages:i,entities:{...null==s?void 0:s.entities,...null==i?void 0:i.entities}}}),[null==m||null==(a=m.dm_message_slice_result)?void 0:a.items]),k=(e=>{const a=l.a.useRef();return l.a.useEffect((()=>{a.current=e})),a.current})(m);return l.a.useEffect((()=>{Object(Oa.a)(m,k)||d(ma(b,!0))}),[b,m,k,d]),l.a.createElement(Pa.a,{cacheKey:Va,footer:y?null:n,identityFunction:qa,items:null==v?void 0:v.result,noItemsRenderer:t,onNearEnd:g,onScrollEnd:s,renderer:r({conversationIds:null==_?void 0:_.result,isMessageItem:!0,messageIds:null==v?void 0:v.result,pinConversation:i,unpinConversation:c}),withoutHeadroom:!0})},Ga=aa.a.create((e=>({activityIndicatior:{paddingVertical:250}})));function Wa(e){return l.a.createElement(Na.a,{errorConfig:za},l.a.createElement(l.a.Suspense,{fallback:l.a.createElement(Ra.a,{style:Ga.activityIndicatior})},l.a.createElement(Qa,e)))}var $a=n("j7Bv"),Ya=n("VwDm"),Xa=n("hOZg");const Za=m.a.dbd5d40f;class Ja extends l.a.PureComponent{render(){const{clearRecentSearch:e,handleRecentSearchClick:a,recentSearch:n}=this.props,t=l.a.createElement($a.a,{Icon:Ya.a,color:"neutral",size:"xLarge",style:en.searchIcon}),s=[en.listItemView,en.bottomBorder];return l.a.createElement(ce.a,{onPress:a,style:s},l.a.createElement(Q.a,null,l.a.createElement(de.a,{avatarCell:t,avatarSize:"xLarge",cellStyle:en.avatarColumn},l.a.createElement(Q.a,{style:en.container},l.a.createElement(u.b,{numberOfLines:1},n),l.a.createElement(ie.a,{accessibilityLabel:Za,borderColor:"transparent",icon:l.a.createElement(Xa.a,null),onPress:e,type:"brandText"})))))}}const en=aa.a.create((e=>({container:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},searchIcon:{marginRight:e.spaces.space12,padding:e.spaces.space4},avatarColumn:{flexGrow:1,minWidth:"32px"},bottomBorder:{borderBottomStyle:"solid",borderBottomWidth:e.borderWidths.small,borderBottomColor:e.colors.borderColor},listItemView:{backgroundColor:e.colors.cellBackground,paddingHorizontal:e.componentDimensions.gutterHorizontal,paddingVertical:e.spaces.space12,width:"100%"}})));var an=Ja,nn=n("DbJc"),tn=n("IG4P"),ln=n("RJrc"),sn=n("TnY3"),rn=n("FIs5"),on=n("6OUF"),cn=n("k/OQ"),dn=n("95Se");const un=e=>e,hn=m.a.b08821f3,pn=m.a.a66ac766,mn=m.a.fe61929d,gn=m.a.a846382a,yn=m.a.b9dae4f4,bn=m.a.e7fb2027,_n=m.a.b92a21d8,vn=m.a.jdc67c42,kn=m.a.e8581ccd,En=m.a.f08940ab,fn=m.a.gaae1fd5,Sn=m.a.i5d7593a,In=m.a.f8321d82,Cn=m.a.c94ac69d,Fn=m.a.a2f8105f,xn=m.a.g2fd3205,Tn=m.a.fb3c8e74;class wn extends l.a.Component{constructor(...e){super(...e),this.state={debouncedQuery:"",isLoadingMore:!1,isRefreshing:!1},this._messageSearchEnabled=this.context.featureSwitches.isTrue("dm_inbox_search_message_results_enabled")&&this.context.featureSwitches.isTrue("direct_messages_incremental_holdback_2022h1"),this._modularSearchEnabled=this.context.featureSwitches.isTrue("dm_inbox_search_modular_results_enabled"),this._setInputRef=e=>{this._textInputRef=e},this._renderEmptyDMSearchInbox=()=>{const{analytics:e,query:a}=this.props,{debouncedQuery:n}=this.state;return n&&a?(e.scribe({component:"search",element:"results",action:"empty"}),l.a.createElement(rn.a,{buttonLink:"/messages/compose",buttonText:En,header:_n({query:n}),message:this._messageSearchEnabled?kn:vn,onButtonPress:this._handleComposeButtonPress})):l.a.createElement(Q.a,{style:Ln.emptyState},l.a.createElement(u.b,{align:"center",color:"gray700"},this._messageSearchEnabled?Sn:fn))},this._renderRecentSearches=()=>{const{analytics:e,query:a,recentSearches:n}=this.props;return n.length&&!a?l.a.createElement(l.a.Fragment,null,l.a.createElement(Ge.a,{analytics:e,clearRecentSearches:this._clearRecentSearches,headerText:Tn,withClearButton:!0}),n.map((e=>l.a.createElement(an,{clearRecentSearch:a=>this._handleClearRecentSearch(a,e),handleRecentSearchClick:()=>this._handleRecentSearchClick(e),key:e,recentSearch:e})))):this._renderEmptyDMSearchInbox()},this._renderAllDMSearchResultsTab=()=>{const{location:e,pinConversation:a,renderInboxItem:n,unpinConversation:t}=this.props,{debouncedQuery:s}=this.state;return s?l.a.createElement(ba,{loadingLabel:pn,location:e,pinConversation:a,query:s,renderEmptyState:this._renderEmptyDMSearchInbox,renderInboxItem:n,unpinConversation:t}):this._renderEmptyDMSearchInbox()},this._renderConversationsTab=e=>{const{pinConversation:a,renderInboxItem:n,unpinConversation:t}=this.props,{debouncedQuery:s}=this.state;return l.a.createElement(Da,{footer:this._renderFooter(),onScrollEnd:this._handleScrollEnd,pinConversation:a,query:s,renderEmptyState:this._renderEmptyDMSearchInbox,renderInboxItem:n,tabType:e?pe.i.GROUPS:pe.i.PEOPLE,unpinConversation:t})},this._renderMessagesTab=()=>{const{pinConversation:e,renderInboxItem:a,unpinConversation:n}=this.props,{debouncedQuery:t}=this.state;return t?l.a.createElement(Wa,{footer:this._renderFooter(),noItemsRenderer:this._renderEmptyDMSearchInbox,onScrollEnd:this._handleScrollEnd,pinConversation:e,renderInboxItem:a,searchTerm:t,unpinConversation:n}):this._renderEmptyDMSearchInbox()},this._renderTabContent=()=>{const{location:e}=this.props,{tab:a}=(null==e?void 0:e.state)||{};switch(a){case xn:return this._renderConversationsTab(!1);case Cn:return this._renderConversationsTab(!0);case Fn:return this._renderMessagesTab();default:return this._renderAllDMSearchResultsTab()}},this._renderSearchResults=()=>{const{accessibilityTitle:e,pinConversation:a,renderInboxItem:n,searchConversationIds:t,unpinConversation:s}=this.props,{isRefreshing:i}=this.state;return l.a.createElement(Ca.a,null,l.a.createElement(tn.a,{isRefreshing:i,onRefresh:this._handlePullToRefresh},l.a.createElement(Pa.a,{accessibilityRole:"tablist",accessibilityTitle:e,anchoring:nn.a,assumedItemHeight:100,cacheKey:"dmSearchInbox",footer:this._renderFooter(),identityFunction:un,items:t,noItemsRenderer:this._renderRecentSearches,onNearEnd:this._handleNearEnd,onScrollEnd:this._handleScrollEnd,renderer:n({conversationIds:t,pinConversation:a,unpinConversation:s}),withoutHeadroom:!0})))},this._renderFooter=()=>this.state.isLoadingMore?l.a.createElement(ln.a,null):l.a.createElement(Q.a,{style:Ln.footerContainer},l.a.createElement(u.b,{align:"center",size:"body",weight:"bold"},bn),l.a.createElement(oe.a,{interactiveStyles:null},l.a.createElement(u.b,{align:"center",color:"primary",onPress:this._handleFooterClick,size:"subtext2",withInteractiveStyling:!0},yn))),this._clearRecentSearches=()=>{const{analytics:e,clearRecentSearches:a}=this.props;e.scribe({component:"recent_search",action:"clear"}),a()},this._handleComposeButtonPress=()=>{const{analytics:e}=this.props;e.scribe({component:"search",element:"empty_results",action:"compose"})},this._handleFooterClick=()=>{var e,a;null==(e=this._textInputRef)||e.clear(),null==(a=this._textInputRef)||a.focus()},this._handleRefetchSearch=()=>{const{analytics:e,createLocalApiErrorHandler:a,search:n}=this.props,{debouncedQuery:t}=this.state;n&&t&&(e.scribe({component:"search",element:"retry",action:"click"}),n({query:t.toLowerCase(),preserveResults:!1,fetchNextPage:!1}).catch(a()))},this._handlePullToRefresh=()=>{const{createLocalApiErrorHandler:e,search:a}=this.props,{debouncedQuery:n}=this.state;this.setState({isRefreshing:!0}),a&&n&&a({query:n.toLowerCase(),preserveResults:!0,fetchNextPage:!1}).then((()=>this.setState({isRefreshing:!1}))).catch((a=>(this.setState({isRefreshing:!1}),e()(a))))},this._handleSearchChangeInner=e=>{const{createLocalApiErrorHandler:a,onQueryChange:n,search:t}=this.props;n(e),this.setState({debouncedQuery:e}),t&&e&&!this._modularSearchEnabled&&t({query:e,preserveResults:!1,fetchNextPage:!1}).catch(a())},this._handleSearchChangeDebounced=Object(Ia.a)(this._handleSearchChangeInner,200),this._handleSearchChange=({currentTarget:{value:e}})=>{const{onQueryChange:a}=this.props;(e&&e.trim()||!e)&&(a(e),this._handleSearchChangeDebounced(e))},this._handleNearEnd=()=>{const{analytics:e,search:a}=this.props,{debouncedQuery:n}=this.state;this.setState({isLoadingMore:!0}),n&&(e.scribe({component:"search",element:"results",action:"get_older"}),a({query:n,preserveResults:!1,fetchNextPage:!0}).finally((()=>this.setState({isLoadingMore:!1}))))},this._handleScrollEnd=()=>{const{addRecentSearch:e,analytics:a,query:n}=this.props,{debouncedQuery:t}=this.state;t&&n&&(e(n),a.scribe({component:"recent_search",action:"add"}))},this._handleSearchClear=()=>this._handleSearchChangeInner(""),this._handleHideRecentSearches=()=>{const{hideRecentSearches:e}=this.props;e()},this._handleAddRecentSearch=({currentTarget:{value:e}})=>{const{addRecentSearch:a,analytics:n}=this.props;e&&(a(e),n.scribe({component:"recent_search",action:"add"}),this._textInputRef&&this._textInputRef.blur())},this._handleRecentSearchClick=e=>{const{analytics:a,onQueryChange:n}=this.props;n(e),a.scribe({component:"recent_search",action:"click"}),this._handleSearchChangeInner(e)},this._handleClearRecentSearch=(e,a)=>{const{analytics:n,clearRecentSearch:t}=this.props;e.stopPropagation(),e.preventDefault(),n.scribe({component:"recent_search",action:"clear"}),t(a)}}componentDidMount(){var e;const{location:a}=this.props;var n;null!=a&&null!=(e=a.state)&&e.searchQuery&&this._handleSearchChangeInner(null==a||null==(n=a.state)?void 0:n.searchQuery);this._textInputRef&&this._textInputRef.focus()}componentDidUpdate(e){const{analytics:a,query:n,recentSearches:t}=this.props;e.query||!n||t.includes(n)||a.scribe({component:"search",action:"began_typing"})}render(){const{location:e,query:a,searchFetchStatus:n}=this.props,t=!(this.context.featureSwitches.isTrue("dm_vdl_enabled")&&this.context.featureSwitches.isTrue("dm_vdl_inbox_p0_enabled")||this._modularSearchEnabled&&a),s=[Ln.searchInput,t?Ln.searchInputBorder:void 0],{tab:i}=(null==e?void 0:e.state)||{},r=[In,xn,Cn];this._messageSearchEnabled&&r.push(Fn);const o=r.map((a=>({key:a,label:a,accessibilityLabel:a,isActive:()=>i===a||!i&&a===In,to:{...e,state:{...e.state,tab:a}}}))),c=i===Fn&&this._messageSearchEnabled;return l.a.createElement(l.a.Fragment,null,l.a.createElement(Q.a,{style:s},l.a.createElement(ie.a,{accessibilityLabel:hn,icon:l.a.createElement(dn.a,null),onPress:this._handleHideRecentSearches,pullLeft:!0,type:"primaryText"}),l.a.createElement(on.a,{Icon:Ya.a,autoComplete:"off",onChange:this._handleSearchChange,onClear:this._handleSearchClear,onSubmitEditing:this._handleAddRecentSearch,placeholder:this._messageSearchEnabled?gn:mn,ref:this._setInputRef,value:a,withClearButton:!0})),this._modularSearchEnabled&&(a||i===xn||i===Cn||c)?l.a.createElement(l.a.Fragment,null,l.a.createElement(cn.a,{links:o}),this._renderTabContent()):l.a.createElement(Je.a,{accessibilityLabel:pn,fetchStatus:n,onRequestRetry:this._handleRefetchSearch,render:this._renderSearchResults}))}}wn.contextType=i.a,wn.defaultProps={recentSearches:[],searchConversationIds:[],query:""};const Ln=aa.a.create((e=>({emptyState:{marginTop:e.spaces.space32},searchInput:{backgroundColor:e.colors.cellBackground,padding:e.spaces.space12,flexDirection:"row",alignItems:"center",zIndex:1},searchInputBorder:{borderBottomColor:e.colors.borderColor,borderBottomStyle:"solid",borderBottomWidth:e.borderWidths.small},footerContainer:{marginVertical:e.spaces.space32}})));var Kn=Object(sn.a)(Sa(wn)),Mn=n("UIzd"),Dn=n.n(Mn),Rn=n("OIs+");const On=m.a.cb367657,Pn=m.a.ie9a7e48,An=m.a.hd3927c6,Nn=m.a.f1ac0968,Hn={[Rn.a.Offline]:{toast:{text:Pn}},defaultToast:{text:On},showToast:!0},Un={[Rn.a.Offline]:{toast:{text:Nn}},defaultToast:{text:An},showToast:!0};var Bn,jn,Vn,zn=n("9SqB"),qn=n.n(zn),Qn=n("Ud88"),Gn=n.n(Qn);const Wn=m.a.e4b3f520,$n=m.a.ae4d666a,Yn=e=>e,Xn=m.a.a219e217,Zn=m.a.d571e4f8,Jn=m.a.a551bf7d,et=m.a.d98e066b,at=m.a.j302dba7,nt=void 0!==Bn?Bn:Bn=n("X8um"),tt={context:"DM_PINNED_INBOX"},lt=e=>{var a;const t=Object(Ha.c)(),{accessibilityTitle:s,analytics:r,cacheKey:o,conversationIds:c,createLocalApiErrorHandler:d,footer:u,header:h,onNearEnd:p,pinnedConversationIds:m,renderEmptyDMInbox:g,renderInboxItem:y,showSearchView:b,withKeyboardShortcuts:_}=e,k=Gn()(),{data:E}=Object(Ba.a)(nt,{label:he.a.PINNED}),f=l.a.useMemo((()=>{var e;return(null==E||null==(e=E.labeled_conversation_slice)?void 0:e.items)||[]}),[E]),{entities:S}=Object(Aa.b)(f,[We.a]),{featureSwitches:I}=l.a.useContext(i.a),C=I.getValue("dm_conversation_labels_max_pinned_count"),[x,T]=l.a.useState(!1),[w,L]=l.a.useState(!1),K=(e=>{const a=l.a.useRef();return l.a.useEffect((()=>{a.current=e})),a.current})(E);l.a.useEffect((()=>{var e;const a=(null==K||null==(e=K.labeled_conversation_slice)?void 0:e.items)||[],n=null==a?void 0:a.filter((e=>-1===f.indexOf(e.rest_id)));n.length&&n.forEach((e=>{var a;const n=null==(a=e.labels)?void 0:a.filter((e=>e.label_type!==he.a.PINNED));t(ma({conversations:{[e.rest_id]:{...e,labels:n}}}))})),t(ma(S,!1))}),[E]);const M=l.a.useCallback((()=>{T(!0);const e=Dn()(k,nt,{label:he.a.PINNED}).toPromise();Promise.all([e,()=>t(v.fetchInbox())]).then((()=>T(!1))).catch((e=>{d()(e),T(!1)}))}),[d,t,k]),[D]=qn()(void 0!==jn?jn:jn=n("ZH9U")),[R]=qn()(void 0!==Vn?Vn:Vn=n("rQjK")),O=l.a.useCallback(((e,a)=>{D({variables:{conversation_id:e,label:he.a.PINNED},onCompleted(n){var l;switch(null==(l=n.add_dm_conversation_label_v3)?void 0:l.__typename){case"DMConversationLabelInfo":{const{label_type:l,timestamp:s}=n.add_dm_conversation_label_v3;t(ma({conversations:{[e]:{...a,labels:[{label_type:l,timestamp:s}]}}})),t(Object(F.b)({ariaOnly:!0,text:et}));break}case"DMConversationLabelUnavailable":{const{failure_reason:e}=n.add_dm_conversation_label_v3;r.scribe({element:"thread",action:"error_shown",data:{error_type:pe.g.MAX_PINS_REACHED}}),"ExceededMaxPinnedConversations"===e&&L(!0);break}}},onError(e){d(Hn)(e)}})}),[t,d,D,r]),P=l.a.useCallback(((e,a)=>{R({variables:{conversation_id:e,label_type:he.a.PINNED},onCompleted(n){var l;const s=a?null==a||null==(l=a.labels)?void 0:l.filter((e=>e.label_type!==he.a.PINNED)):[];t(ma({conversations:{[e]:{...a,labels:s}}})),t(Object(F.b)({ariaOnly:!0,text:at}))},updater(a){var n,t;const l=null==(n=f.find((a=>a.rest_id===e)))?void 0:n.id,s=null==E||null==(t=E.labeled_conversation_slice)?void 0:t.__id;if(!l||!s)return;const i=a.get(l),r=a.get(s);r&&i&&(Object(Qe.b)(r,l),a.delete(l))},onError(e){d(Un)(e)}})}),[d,f,null==E||null==(a=E.labeled_conversation_slice)?void 0:a.__id,t,R]),A=null==c?void 0:c.filter((e=>-1===m.indexOf(e))),N=m.length&&A.length,H=l.a.createElement(l.a.Fragment,null,h,null!=m&&m.length?l.a.createElement(l.a.Fragment,null,st(Wn),m.map(((e,a)=>y({conversationIds:m,pinConversation:O,unpinConversation:P})(e)))):null,N?st($n):null);return null!=c&&c.length?l.a.createElement(l.a.Fragment,null,w?l.a.createElement(W.a,{confirmButtonLabel:Xn,headline:Zn({count:C}),onConfirm:()=>L(!1),text:Jn,withCancelButton:!1}):null,b?l.a.createElement(Kn,{accessibilityTitle:s,analytics:r,conversationIds:c,hideRecentSearches:e.hideRecentSearches,onQueryChange:e.onQueryChange,pinConversation:O,query:e.query,renderInboxItem:e.renderInboxItem,unpinConversation:P}):l.a.createElement(tn.a,{isRefreshing:x,onRefresh:M},o&&null!=A&&A.length?l.a.createElement(Pa.a,{accessibilityRole:"tablist",accessibilityTitle:s,anchoring:nn.a,assumedItemHeight:100,cacheKey:o,footer:u,header:H,identityFunction:Yn,items:A,onNearEnd:p,renderer:y({conversationIds:A,pinConversation:O,unpinConversation:P}),withKeyboardShortcuts:_,withoutHeadroom:!0}):H)):g()},st=e=>l.a.createElement(Q.a,null,l.a.createElement(Ge.a,{headerText:e,isInboxLabelHeader:!0}));function it(e){return l.a.createElement(Na.a,{errorConfig:tt},l.a.createElement(lt,e))}var rt=qe(l.a.memo(it)),ot=n("dwig"),ct=n("QB0K"),dt=n("Avzu"),ut=n("FRNI");const ht=m.a.h845f281,pt=m.a.f325afc3;function mt(){return l.a.createElement(ct.a,{accessibilityLabel:ht,href:"/messages/compose",icon:l.a.createElement(dt.a,null),label:ht,scribeComponent:"floating_dm_button",shortLabel:pt,testID:ut.a.message})}var gt=l.a.memo(mt),yt=n("tI3i"),bt=n.n(yt),_t=n("sNn6"),vt=n("883S"),kt=n("yoO3"),Et=n("GSsg"),ft=n("2g+p"),St=n("mw9i"),It=n("BcsE"),Ct=n("+d3d");const Ft=e=>e,xt=m.a.a66ac766,Tt=m.a.fe61929d,wt=m.a.a846382a;class Lt extends l.a.Component{constructor(e,a){var n,t,i,r,o,c,d;super(e,a),this.state={showSearchView:!(null==(n=this.props)||null==(t=n.location)||null==(i=t.state)||!i.searchQuery),searchQuery:null!=(r=null==(o=this.props)||null==(c=o.location)||null==(d=c.state)?void 0:d.searchQuery)?r:""},this._enablePinnedInbox=this.context.featureSwitches.isTrue("dm_conversation_labels_pinned_enabled")&&this.context.featureSwitches.isTrue("direct_messages_incremental_holdback_2022h1"),this._messageSearchEnabled=this.context.featureSwitches.isTrue("dm_inbox_search_message_results_enabled")&&this.context.featureSwitches.isTrue("direct_messages_incremental_holdback_2022h1"),this._modularSearchEnabled=this.context.featureSwitches.isTrue("dm_inbox_search_modular_results_enabled"),this._isVDLEnabled=this.context.featureSwitches.isTrue("dm_vdl_enabled")&&this.context.featureSwitches.isTrue("dm_vdl_inbox_p0_enabled"),this._render=()=>{const{withPinnedInbox:e}=this.props;return this._enablePinnedInbox&&e?this._renderPinnedInbox():this._renderInbox()},this._renderFocusedSearch=()=>{const{accessibilityTitle:e,analytics:a,conversationIds:n}=this.props,{searchQuery:t}=this.state;return l.a.createElement(Kn,{accessibilityTitle:e,analytics:a,conversationIds:n,hideRecentSearches:this._hideRecentSearches,onQueryChange:this._handleQueryChange,query:t,renderInboxItem:this._renderInboxItem})},this._renderInbox=()=>{var e,a;const{accessibilityTitle:n,conversationIds:t,footer:s,isDrawer:i,isRefreshing:r,renderEmptyDMInbox:o,virtualScrollerCacheKey:c}=this.props,{showSearchView:d}=this.state;return d||null!=(e=this.props.location)&&null!=(a=e.state)&&a.searchQuery?this._renderFocusedSearch():l.a.createElement(tn.a,{isRefreshing:r,onRefresh:this._handlePullToRefresh},c&&t?l.a.createElement(Pa.a,{accessibilityRole:"tablist",accessibilityTitle:n,anchoring:nn.a,assumedItemHeight:100,cacheKey:c,footer:s,header:this._renderHeader(),identityFunction:Ft,items:t,noItemsRenderer:o,onNearEnd:this._handleNearEnd,renderer:this._renderInboxItem({conversationIds:t}),withKeyboardShortcuts:!i,withoutHeadroom:!0}):null)},this._handleNearEnd=()=>{this._handleHistoryRequest()},this._handleQueryChange=e=>{this.setState({searchQuery:e})},this._handleSearchChange=({currentTarget:{value:e}})=>{this.state.showSearchView||this.setState({showSearchView:!0})},this._handleSearchClick=()=>{const{analytics:e}=this.props;e.scribe({component:"search",action:"click"}),this.setState({showSearchView:!0})},this._hideRecentSearches=()=>{this.setState({showSearchView:!1,searchQuery:""})},this._renderInboxItem=({conversationIds:e,isMessageItem:a=!1,messageIds:n,pinConversation:t,unpinConversation:i})=>(r,o)=>{const{loggedInUserId:c}=this.context,{location:d}=this.props,{searchQuery:u}=this.state,h=a?(n||[]).indexOf(r):-1,p=-1!==h&&null!=e&&e.length?e[h]:null,m=p?r:"",g=p||r,y={pathname:`/messages/${g}`,state:{...null==d?void 0:d.state,entryPoint:null,searchQuery:u}},b=g&&null!=e&&e.length?e.indexOf(g):null,_=Object(It.a)(b)?b+1:0;bt()(!!c,"loggedInUserId must be defined"),o&&o(!0);const v=e=>l.a.createElement(ze,{conversationId:g,inboxType:this.props.inboxType,isActive:e,isMessageItem:a,key:g,link:y,messageId:m,onClick:this._handleConversationClick,perspective:c,pinConversation:t,position:_,searchQuery:u,unpinConversation:i});return this._isVDLEnabled?l.a.createElement(_t.a,{exact:!1,path:y.pathname},v):l.a.createElement(s.a,{exact:!1,path:y.pathname},v)},this._renderPinnedInbox=()=>{const{accessibilityTitle:e,conversationIds:a,footer:n,isDrawer:t,renderEmptyDMInbox:s,virtualScrollerCacheKey:i}=this.props,{searchQuery:r,showSearchView:o}=this.state;return a.length?l.a.createElement(rt,{accessibilityTitle:e,cacheKey:i,conversationIds:a,footer:n,header:this._renderHeader(),hideRecentSearches:this._hideRecentSearches,onNearEnd:this._handleNearEnd,onQueryChange:this._handleQueryChange,query:r,renderEmptyDMInbox:s,renderInboxItem:this._renderInboxItem,showSearchView:o,withKeyboardShortcuts:!t}):s()},this._handleFetchInitialWrapper=()=>{this._handleFetchInitial()},this._handleFetchInitial=()=>{const{createLocalApiErrorHandler:e,fetchInboxIfNeeded:a,fetchUpdates:n}=this.props;return a().then(this._updateLastSeenEventId,e()).then((()=>{this._updatePolling.start()})).then((()=>n().catch(e())))},this._handleConversationClick=(e,a,n,t)=>{const{analytics:l,customCellClick:s}=this.props,i=(null==n?void 0:n.participants.length)||0,r=(null==n?void 0:n.type)===v.CONVERSATION_TYPE.GROUP;l.scribe({element:"thread",action:"click",data:{event_value:this.state.searchQuery.length,conversation_id:a,conversation_participant_count:i,conversation_type:r?pe.j.GROUP:pe.j.ONE_TO_ONE,position:t}}),s&&s(e,a)},this._handleEmptyDMInboxImpression=()=>{const{analytics:e}=this.props;e.scribe({component:"empty_message",action:"impression"})},this._handlePullToRefresh=()=>{const{createLocalApiErrorHandler:e,fetchInbox:a}=this.props;a().then(this._updateLastSeenEventId,e())},this._updateLastSeenEventIdIfActive=()=>{if("background"!==ft.a.currentState)return this._updateLastSeenEventId()},this._renderHeader=()=>{const{renderStickyContent:e,withDmSearch:a}=this.props,n=[Kt.searchInput,this._isVDLEnabled?void 0:Kt.searchInputBorder];return l.a.createElement(l.a.Fragment,null,a?l.a.createElement(Q.a,{onClick:this._handleSearchClick,style:n},l.a.createElement(on.a,{Icon:Ya.a,autoComplete:"off",isCompact:!0,onChange:this._handleSearchChange,placeholder:this._messageSearchEnabled?wt:Tt,withClearButton:!0})):null,e?e():null)},this._updateLastSeenEventId=()=>{const{createLocalApiErrorHandler:e,updateLastSeenEventId:a}=this.props;return a().catch(e())},this._fab=l.a.createElement(gt,null)}componentDidMount(){const{createLocalApiErrorHandler:e,fetchInboxHistory:a,fetchUpdates:n}=this.props;return this._updatePolling=new Et.a((()=>{n().then(this._updateLastSeenEventIdIfActive,e(vt.a))}),{interval:8e3}),this._handleHistoryRequest=Object(Ct.a)(((...n)=>{a(...n).catch(e())}),1e3),this._handleFetchInitial()}componentWillUnmount(){this._updatePolling.stop()}render(){return l.a.createElement(kt.a,null,l.a.createElement(_,null),l.a.createElement(ot.a,{component:St.a,fab:this._fab,style:Kt.root},l.a.createElement(Je.a,{accessibilityLabel:xt,fetchStatus:this.props.fetchStatus,onRequestRetry:this._handleFetchInitialWrapper,render:this._render})))}}Lt.contextType=i.a,Lt.defaultProps={conversationIds:[],inboxType:he.d.PRIMARY,isDrawer:!1,withDmSearch:!1,withPinnedInbox:!1};const Kt=aa.a.create((e=>({root:{backgroundColor:e.colors.cellBackground,flexGrow:1},searchInput:{backgroundColor:e.colors.cellBackground,padding:e.spaces.space12,zIndex:1},searchInputBorder:{borderBottomColor:e.colors.borderColor,borderBottomStyle:"solid",borderBottomWidth:"1px"}})));a.a=Object(sn.a)(f(Lt))},rQjK:function(e,a,n){"use strict";n.r(a);const t={fragment:{argumentDefinitions:l=[{defaultValue:null,kind:"LocalArgument",name:"conversation_id"},{defaultValue:null,kind:"LocalArgument",name:"label_type"}],kind:"Fragment",metadata:null,name:"DMPinnedInboxDelete_Mutation",selections:s=[{alias:null,args:[{kind:"Variable",name:"conversation_id",variableName:"conversation_id"},{kind:"Variable",name:"label_type",variableName:"label_type"}],kind:"ScalarField",name:"dm_conversation_label_delete",storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:l,kind:"Operation",name:"DMPinnedInboxDelete_Mutation",selections:s},params:{id:"_TQxP2Rb0expwVP9ktGrTQ",metadata:{},name:"DMPinnedInboxDelete_Mutation",operationKind:"mutation",text:null}};var l,s;t.hash="f0ba5e0b671c54ae94c7322d3036a375",a.default=t},y59G:function(e,a,n){"use strict";n.r(a);const t={fragment:{argumentDefinitions:[l={defaultValue:null,kind:"LocalArgument",name:"cursor"},s={defaultValue:null,kind:"LocalArgument",name:"query"},i={defaultValue:null,kind:"LocalArgument",name:"withAttachments"},r={defaultValue:!1,kind:"LocalArgument",name:"withDmMuting"},o={defaultValue:null,kind:"LocalArgument",name:"withSafetyModeUserFields"},c={defaultValue:null,kind:"LocalArgument",name:"withSuperFollowsUserFields"}],kind:"Fragment",metadata:null,name:"DMMessageSearchTabQuery",selections:[{alias:"dm_message_slice_result",args:[d={kind:"Variable",name:"query",variableName:"query"},u={kind:"Literal",name:"s",value:19}],concreteType:null,kind:"LinkedField",name:"__DMMessageSearchTabQuery_dm_message_slice_result_slice",plural:!1,selections:[{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"items",plural:!0,selections:[{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"DMEvent",kind:"LinkedField",name:"dm_event",plural:!1,selections:[h={alias:null,args:null,kind:"ScalarField",name:"rest_id",storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,concreteType:"DMEventMetadata",kind:"LinkedField",name:"legacy",plural:!1,selections:[m={alias:null,args:null,kind:"ScalarField",name:"affects_sort",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"created_at_millis",storageKey:null},y={alias:null,args:null,kind:"ScalarField",name:"request_id",storageKey:null},b={alias:null,args:null,kind:"ScalarField",name:"event_id",storageKey:null},_={alias:null,args:null,kind:"ScalarField",name:"event_type",storageKey:null},{alias:null,args:null,concreteType:"DMConversation",kind:"LinkedField",name:"conversation",plural:!1,selections:[p,h,{alias:null,args:null,concreteType:"ConversationInfo",kind:"LinkedField",name:"legacy",plural:!1,selections:[v={alias:null,args:null,kind:"ScalarField",name:"conversation_id",storageKey:null},{alias:null,args:null,concreteType:"ConversationMetadata",kind:"LinkedField",name:"metadata",plural:!1,selections:[v,k={alias:null,args:null,kind:"ScalarField",name:"conversation_type",storageKey:null},E={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"created_by_user_results",plural:!1,selections:I=[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"result",plural:!1,selections:[{kind:"InlineFragment",selections:[p,h,S={alias:null,args:null,concreteType:"ApiUser",kind:"LinkedField",name:"legacy",plural:!1,selections:[E,f={alias:null,args:null,kind:"ScalarField",name:"screen_name",storageKey:null}],storageKey:null}],type:"User",abstractKey:null}],storageKey:null}],storageKey:null},g,{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"admin_user_results",plural:!1,selections:I,storageKey:null},{alias:null,args:null,concreteType:"ApiMedia",kind:"LinkedField",name:"avatar",plural:!1,selections:[p,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"media_info",plural:!1,selections:[T={kind:"InlineFragment",selections:[C={alias:null,args:null,kind:"ScalarField",name:"original_img_url",storageKey:null},F={alias:null,args:null,kind:"ScalarField",name:"original_img_width",storageKey:null},x={alias:null,args:null,kind:"ScalarField",name:"original_img_height",storageKey:null}],type:"ApiImage",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ParticipantConversationMetadata",kind:"LinkedField",name:"participants_metadata",plural:!0,selections:[{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"user_results",plural:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"result",plural:!1,selections:[{kind:"InlineFragment",selections:[p,h,K={alias:null,args:null,concreteType:"ApiUser",kind:"LinkedField",name:"legacy",plural:!1,selections:[w={alias:null,args:null,kind:"ScalarField",name:"id_str",storageKey:null},E,f,L={alias:null,args:null,kind:"ScalarField",name:"profile_image_url_https",storageKey:null}],storageKey:null}],type:"User",abstractKey:null}],storageKey:null}],storageKey:null},M={alias:null,args:null,kind:"ScalarField",name:"last_read_event_id",storageKey:null},D={alias:null,args:null,kind:"ScalarField",name:"join_time_millis",storageKey:null},R={alias:null,args:null,kind:"ScalarField",name:"join_conversation_event_id",storageKey:null}],storageKey:null},O={alias:null,args:null,concreteType:"PerspectivalConversationMetadata",kind:"LinkedField",name:"perspectival_conversation_metadata",plural:!1,selections:[M,{alias:null,args:null,kind:"ScalarField",name:"low_quality",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"muted",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"muted_due_to_muted_user",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"read_only",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"trusted",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"DMEventDetail",kind:"LinkedField",name:"event_detail",plural:!1,selections:[P={alias:null,args:null,concreteType:"DMInitialLowQualityState",kind:"LinkedField",name:"initial_low_quality_state",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"is_low_quality",storageKey:null}],storageKey:null},A={alias:null,args:null,kind:"ScalarField",name:"is_new_one_to_one_convo",storageKey:null},N={alias:null,args:null,kind:"ScalarField",name:"is_spam_hide",storageKey:null},H={alias:null,args:null,kind:"ScalarField",name:"marked_as_abuse",storageKey:null},U={alias:null,args:null,kind:"ScalarField",name:"message_id",storageKey:null},E,B={alias:null,args:null,kind:"ScalarField",name:"possibly_spam",storageKey:null},j={alias:null,args:null,kind:"ScalarField",name:"sender_registration_token",storageKey:null},{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"users_results",plural:!0,selections:I,storageKey:null},{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"participants_snapshot_results",plural:!0,selections:I,storageKey:null},{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"initiating_user_results",plural:!1,selections:I,storageKey:null},{alias:null,args:null,concreteType:"DirectMessageInfo",kind:"LinkedField",name:"dm",plural:!1,selections:[V={alias:null,args:null,kind:"ScalarField",name:"created_at_sec",storageKey:null},p,z={alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null},{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"recipient_results",plural:!1,selections:I,storageKey:null},{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"sender_results",plural:!1,selections:I,storageKey:null},{condition:"withAttachments",kind:"Condition",passingValue:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"attachments",plural:!0,selections:[q={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},ne={kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ApiMedia",kind:"LinkedField",name:"media",plural:!1,selections:[p,{alias:null,args:null,kind:"ScalarField",name:"media_key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"media_id",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"media_info",plural:!1,selections:[q,{kind:"InlineFragment",selections:X=[Q={alias:null,args:null,kind:"ScalarField",name:"alt_text",storageKey:null},x,F,C,{alias:null,args:null,concreteType:"ApiMediaRect",kind:"LinkedField",name:"salient_rect",plural:!1,selections:[G={alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"left",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"top",storageKey:null},W={alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"MediaColorInfo",kind:"LinkedField",name:"color_info",plural:!1,selections:[{alias:null,args:null,concreteType:"MediaColorPaletteItem",kind:"LinkedField",name:"palette",plural:!0,selections:[$={alias:null,args:null,kind:"ScalarField",name:"percentage",storageKey:null},{alias:null,args:null,concreteType:"MediaColor",kind:"LinkedField",name:"rgb",plural:!1,selections:Y=[{alias:null,args:null,kind:"ScalarField",name:"blue",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"green",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"red",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"ApiImage",abstractKey:null},{kind:"InlineFragment",selections:[Z={alias:null,args:null,concreteType:"AspectRatio",kind:"LinkedField",name:"aspect_ratio",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"denominator",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"numerator",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"duration_millis",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"embeddable",storageKey:null},J={alias:null,args:null,concreteType:"ApiImage",kind:"LinkedField",name:"preview_image",plural:!1,selections:X,storageKey:null},ae={alias:null,args:null,concreteType:"VideoVariant",kind:"LinkedField",name:"variants",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"bit_rate",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"content_type",storageKey:null},ee={alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"view_count",storageKey:null}],type:"ApiVideo",abstractKey:null},{kind:"InlineFragment",selections:[Q,Z,J,ae],type:"ApiGif",abstractKey:null}],storageKey:null}],storageKey:null}],type:"DMMediaAttachment",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"Card",kind:"LinkedField",name:"card",plural:!1,selections:[h,{alias:null,args:null,concreteType:"LegacyCard",kind:"LinkedField",name:"legacy",plural:!1,selections:[se={alias:null,args:null,concreteType:"LegacyCardBinding",kind:"LinkedField",name:"binding_values",plural:!0,selections:[te={alias:null,args:null,kind:"ScalarField",name:"key",storageKey:null},{alias:null,args:null,concreteType:"ApiCardBindingValue",kind:"LinkedField",name:"value",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"boolean_value",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"double_value",storageKey:null},{alias:null,args:null,concreteType:"ApiCardBindingImageValue",kind:"LinkedField",name:"image_value",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"alt",storageKey:null},G,W,ee],storageKey:null},{alias:null,args:null,concreteType:"ApiMediaEntityColorPalette",kind:"LinkedField",name:"image_color_value",plural:!1,selections:[{alias:null,args:null,concreteType:"ApiMediaEntityColorPaletteColor",kind:"LinkedField",name:"palette",plural:!0,selections:[le={alias:null,args:null,concreteType:"ApiMediaEntityColor",kind:"LinkedField",name:"rgb",plural:!1,selections:Y,storageKey:null},$],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"integer_value",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"scribe_key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"string_value",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null},{alias:null,args:null,concreteType:"ApiCardBindingUserValue",kind:"LinkedField",name:"user_value",plural:!1,selections:[w,{alias:null,args:null,kind:"ScalarField",name:"path",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},ie={alias:null,args:null,concreteType:"ApiCardPlatform",kind:"LinkedField",name:"card_platform",plural:!1,selections:[{alias:null,args:null,concreteType:"ApiCardPlatformPlatform",kind:"LinkedField",name:"platform",plural:!1,selections:[{alias:null,args:null,concreteType:"ApiCardPlatformAudience",kind:"LinkedField",name:"audience",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"bucket",storageKey:null},E],storageKey:null},{alias:null,args:null,concreteType:"ApiCardPlatformDevice",kind:"LinkedField",name:"device",plural:!1,selections:[E,{alias:null,args:null,kind:"ScalarField",name:"version",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},E,ee,{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user_refs",plural:!0,selections:[p,h,{alias:"affiliates_highlighted_label",args:null,concreteType:"HighlightedUserLabelResponse",kind:"LinkedField",name:"identity_profile_labels_highlighted_label",plural:!1,selections:[{alias:null,args:null,concreteType:"HighlightedUserLabel",kind:"LinkedField",name:"label",plural:!1,selections:[oe={alias:null,args:null,concreteType:"TimelineUrl",kind:"LinkedField",name:"url",plural:!1,selections:[re={alias:"urlType",args:null,kind:"ScalarField",name:"url_type",storageKey:null},ee],storageKey:null},ce={alias:null,args:null,concreteType:"BadgeInfo",kind:"LinkedField",name:"badge",plural:!1,selections:[ee],storageKey:null},de={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:"longDescription",args:null,concreteType:"TimelineRichText",kind:"LinkedField",name:"long_description",plural:!1,selections:[ue={alias:null,args:null,kind:"ScalarField",name:"alignment",storageKey:null},he={alias:null,args:null,kind:"ScalarField",name:"rtl",storageKey:null},z,{alias:null,args:null,concreteType:"TimelineRichTextEntity",kind:"LinkedField",name:"entities",plural:!0,selections:[pe={alias:"fromIndex",args:null,kind:"ScalarField",name:"from_index",storageKey:null},me={alias:"toIndex",args:null,kind:"ScalarField",name:"to_index",storageKey:null},ge={alias:null,args:null,kind:"ScalarField",name:"format",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"ref",plural:!1,selections:[ye={alias:"type",args:null,kind:"ScalarField",name:"__typename",storageKey:null},_e={kind:"InlineFragment",selections:be=[z],type:"TimelineRichTextCashtag",abstractKey:null},ve={kind:"InlineFragment",selections:[p,ee],type:"TimelineRichTextList",abstractKey:null},ke={kind:"InlineFragment",selections:be,type:"TimelineRichTextHashtag",abstractKey:null},Ee={kind:"InlineFragment",selections:[ee,re,{alias:"urtEndpointOptions",args:null,concreteType:"TimelineUrtEndpointOptions",kind:"LinkedField",name:"urt_endpoint_options",plural:!1,selections:[{alias:"cacheId",args:null,kind:"ScalarField",name:"cache_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"subtitle",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"title",storageKey:null},{alias:"requestParams",args:null,concreteType:"RequestParamsEntry",kind:"LinkedField",name:"request_params",plural:!0,selections:[te,{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null}],storageKey:null}],type:"TimelineUrl",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"user_results",plural:!1,selections:Ie=[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"result",plural:!1,selections:[q,{kind:"InlineFragment",selections:[fe={alias:null,args:null,concreteType:"ApiUser",kind:"LinkedField",name:"legacy",plural:!1,selections:[f],storageKey:null},h],type:"User",abstractKey:null},Se={kind:"InlineFragment",selections:[{alias:"reason",args:null,kind:"ScalarField",name:"unavailable_reason",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"message",storageKey:null}],type:"UserUnavailable",abstractKey:null}],storageKey:null}],storageKey:null}],type:"TimelineRichTextUser",abstractKey:null},{kind:"InlineFragment",selections:[f,{alias:"mention_results",args:null,concreteType:"UserResults",kind:"LinkedField",name:"user_results",plural:!1,selections:Ie,storageKey:null}],type:"TimelineRichTextMention",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null},Ce={alias:"userLabelType",args:null,kind:"ScalarField",name:"user_label_type",storageKey:null}],storageKey:null}],storageKey:null},Fe={alias:null,args:null,kind:"ScalarField",name:"has_nft_avatar",storageKey:null},Le={alias:null,args:null,concreteType:"ApiUser",kind:"LinkedField",name:"legacy",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"blocked_by",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"blocking",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"can_dm",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"can_media_tag",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"created_at",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"default_profile",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"default_profile_image",storageKey:null},de,{alias:null,args:null,concreteType:"UserEntities",kind:"LinkedField",name:"entities",plural:!1,selections:Te=[{alias:null,args:null,concreteType:"EntitySet",kind:"LinkedField",name:"description",plural:!1,selections:xe=[{alias:null,args:null,concreteType:"UrlsEntity",kind:"LinkedField",name:"urls",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"display_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expanded_url",storageKey:null},ee,{alias:null,args:null,kind:"ScalarField",name:"indices",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"EntitySet",kind:"LinkedField",name:"url",plural:!1,selections:xe,storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"fast_followers_count",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"favourites_count",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"follow_request_sent",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"follow_request_received",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"followed_by",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"followers_count",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"following",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"friends_count",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"has_custom_timelines",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_translator",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"listed_count",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"location",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"media_count",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"muting",storageKey:null},E,{alias:null,args:null,kind:"ScalarField",name:"needs_phone_verification",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"normal_followers_count",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"notifications",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"pinned_tweet_ids_str",storageKey:null},{alias:null,args:null,concreteType:"ApiMediaExtensions",kind:"LinkedField",name:"profile_banner_extensions",plural:!1,selections:we=[{alias:null,args:null,concreteType:"ApiMediaColorExtension",kind:"LinkedField",name:"mediaColor",plural:!1,selections:[{alias:null,args:null,concreteType:"ApiMediaColorExtensionR",kind:"LinkedField",name:"r",plural:!1,selections:[{alias:null,args:null,concreteType:"ApiMediaEntityColorPalette",kind:"LinkedField",name:"ok",plural:!1,selections:[{alias:null,args:null,concreteType:"ApiMediaEntityColorPaletteColor",kind:"LinkedField",name:"palette",plural:!0,selections:[$,le],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profile_banner_url",storageKey:null},{alias:null,args:null,concreteType:"ApiMediaExtensions",kind:"LinkedField",name:"profile_image_extensions",plural:!1,selections:we,storageKey:null},L,{alias:null,args:null,kind:"ScalarField",name:"profile_interstitial_type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"protected",storageKey:null},f,{alias:null,args:null,kind:"ScalarField",name:"statuses_count",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"time_zone",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"translator_type",storageKey:null},ee,{alias:null,args:null,kind:"ScalarField",name:"utc_offset",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"verified",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"want_retweets",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"withheld_description",storageKey:null},{alias:null,args:null,concreteType:"UserEntities",kind:"LinkedField",name:"withheld_entities",plural:!1,selections:Te,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"withheld_in_countries",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"withheld_scope",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"Professional",kind:"LinkedField",name:"professional",plural:!1,selections:[h,Ke={alias:null,args:null,kind:"ScalarField",name:"professional_type",storageKey:null},Me={alias:null,args:null,concreteType:"BusinessCategory",kind:"LinkedField",name:"category",plural:!0,selections:[p,E,{alias:null,args:null,kind:"ScalarField",name:"display",storageKey:null}],storageKey:null}],storageKey:null},De={condition:"withDmMuting",kind:"Condition",passingValue:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"dm_muting",storageKey:null}]},Re={condition:"withSafetyModeUserFields",kind:"Condition",passingValue:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"smart_blocked_by",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"smart_blocking",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"smart_blocking_expiration",storageKey:null}]},Oe={condition:"withSuperFollowsUserFields",kind:"Condition",passingValue:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"super_follow_eligible",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"super_followed_by",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"super_following",storageKey:null}]}],storageKey:null}],storageKey:null}],storageKey:null}],type:"DMCardAttachment",abstractKey:null}],storageKey:null}]}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"DMMessageSearchItem",abstractKey:null}],storageKey:null},Pe={alias:null,args:null,concreteType:"SliceInfo",kind:"LinkedField",name:"slice_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"next_cursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"previous_cursor",storageKey:null}],storageKey:null}],type:"DMMessageSlice",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[l,s,i,c,o,r],kind:"Operation",name:"DMMessageSearchTabQuery",selections:[{alias:null,args:Ae=[{kind:"Variable",name:"cursor",variableName:"cursor"},d,u],concreteType:null,kind:"LinkedField",name:"dm_message_slice_result",plural:!1,selections:[q,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"items",plural:!0,selections:[q,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"DMEvent",kind:"LinkedField",name:"dm_event",plural:!1,selections:[h,p,{alias:null,args:null,concreteType:"DMEventMetadata",kind:"LinkedField",name:"legacy",plural:!1,selections:[m,g,y,b,_,{alias:null,args:null,concreteType:"DMConversation",kind:"LinkedField",name:"conversation",plural:!1,selections:[p,h,{alias:null,args:null,concreteType:"ConversationInfo",kind:"LinkedField",name:"legacy",plural:!1,selections:[v,{alias:null,args:null,concreteType:"ConversationMetadata",kind:"LinkedField",name:"metadata",plural:!1,selections:[v,k,E,{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"created_by_user_results",plural:!1,selections:He=[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"result",plural:!1,selections:[q,{kind:"InlineFragment",selections:[p,h,S,Ne={alias:null,args:null,filters:null,handle:"defaultScalars",key:"",kind:"LinkedHandle",name:"legacy"}],type:"User",abstractKey:null}],storageKey:null}],storageKey:null},g,{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"admin_user_results",plural:!1,selections:He,storageKey:null},{alias:null,args:null,concreteType:"ApiMedia",kind:"LinkedField",name:"avatar",plural:!1,selections:[p,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"media_info",plural:!1,selections:[q,T],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ParticipantConversationMetadata",kind:"LinkedField",name:"participants_metadata",plural:!0,selections:[{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"user_results",plural:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"result",plural:!1,selections:[q,{kind:"InlineFragment",selections:[p,h,K,Ne],type:"User",abstractKey:null}],storageKey:null}],storageKey:null},M,D,R],storageKey:null},O],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"DMEventDetail",kind:"LinkedField",name:"event_detail",plural:!1,selections:[P,A,N,H,U,E,B,j,{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"users_results",plural:!0,selections:He,storageKey:null},{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"participants_snapshot_results",plural:!0,selections:He,storageKey:null},{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"initiating_user_results",plural:!1,selections:He,storageKey:null},{alias:null,args:null,concreteType:"DirectMessageInfo",kind:"LinkedField",name:"dm",plural:!1,selections:[V,p,z,{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"recipient_results",plural:!1,selections:He,storageKey:null},{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"sender_results",plural:!1,selections:He,storageKey:null},{condition:"withAttachments",kind:"Condition",passingValue:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"attachments",plural:!0,selections:[q,ne,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"Card",kind:"LinkedField",name:"card",plural:!1,selections:[h,{alias:null,args:null,concreteType:"LegacyCard",kind:"LinkedField",name:"legacy",plural:!1,selections:[se,ie,E,ee,{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user_refs",plural:!0,selections:[p,h,{alias:"affiliates_highlighted_label",args:null,concreteType:"HighlightedUserLabelResponse",kind:"LinkedField",name:"identity_profile_labels_highlighted_label",plural:!1,selections:[{alias:null,args:null,concreteType:"HighlightedUserLabel",kind:"LinkedField",name:"label",plural:!1,selections:[oe,ce,de,{alias:"longDescription",args:null,concreteType:"TimelineRichText",kind:"LinkedField",name:"long_description",plural:!1,selections:[ue,he,z,{alias:null,args:null,concreteType:"TimelineRichTextEntity",kind:"LinkedField",name:"entities",plural:!0,selections:[pe,me,ge,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"ref",plural:!1,selections:[q,{kind:"TypeDiscriminator",abstractKey:"__isTimelineReferenceObject"},ye,_e,ve,ke,Ee,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"user_results",plural:!1,selections:Ue=[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"result",plural:!1,selections:[q,{kind:"InlineFragment",selections:[fe,Ne,h,p],type:"User",abstractKey:null},Se],storageKey:null}],storageKey:null}],type:"TimelineRichTextUser",abstractKey:null},{kind:"InlineFragment",selections:[f,{alias:"mention_results",args:null,concreteType:"UserResults",kind:"LinkedField",name:"user_results",plural:!1,selections:Ue,storageKey:null}],type:"TimelineRichTextMention",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null},Ce],storageKey:null}],storageKey:null},Fe,Le,Ne,{alias:null,args:null,concreteType:"Professional",kind:"LinkedField",name:"professional",plural:!1,selections:[h,Ke,Me,p],storageKey:null},De,Re,Oe],storageKey:null},{alias:null,args:null,filters:null,handle:"user",key:"",kind:"LinkedHandle",name:"user_refs",handleArgs:[{kind:"Literal",name:"isPlural",value:!0}]}],storageKey:null},p],storageKey:null}],type:"DMCardAttachment",abstractKey:null}],storageKey:null}]}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"DMMessageSearchItem",abstractKey:null}],storageKey:null},Pe],type:"DMMessageSlice",abstractKey:null}],storageKey:null},{alias:null,args:Ae,filters:["query","s"],handle:"slice",key:"DMMessageSearchTabQuery_dm_message_slice_result",kind:"LinkedHandle",name:"dm_message_slice_result"}]},params:{id:"dwe8pudI0w7gOinDfFC0fQ",metadata:{sliceInfoPath:["dm_message_slice_result","slice_info"]},name:"DMMessageSearchTabQuery",operationKind:"query",text:null}};var l,s,i,r,o,c,d,u,h,p,m,g,y,b,_,v,k,E,f,S,I,C,F,x,T,w,L,K,M,D,R,O,P,A,N,H,U,B,j,V,z,q,Q,G,W,$,Y,X,Z,J,ee,ae,ne,te,le,se,ie,re,oe,ce,de,ue,he,pe,me,ge,ye,be,_e,ve,ke,Ee,fe,Se,Ie,Ce,Fe,xe,Te,we,Le,Ke,Me,De,Re,Oe,Pe,Ae,Ne,He,Ue;t.hash="43f462e52881e76aa030f8d291ff5d5a",a.default=t}}]);
//# sourceMappingURL=https://ton.local.twitter.com/responsive-web-internal/sourcemaps/client-web/loader.DMDrawer.ffbd64c5.js.map