(window.webpackJsonp=window.webpackJsonp||[]).push([[179],{WXWl:function(e,t,i){"use strict";var s=i("ERkP"),a=i.n(s),o=i("Lsrn"),n=i("k/Ka");const r=(e={})=>Object(n.a)("svg",{...e,accessibilityHidden:void 0===e.accessibilityLabel,style:[o.a.root,e.style],viewBox:"0 0 24 24"},a.a.createElement("g",null,a.a.createElement("path",{d:"M18.707 10.293l-6-6c-.39-.39-1.023-.39-1.414 0l-6 6c-.39.39-.39 1.023 0 1.414.195.195.45.293.707.293s.512-.098.707-.293L11 7.414V20c0 .553.447 1 1 1s1-.447 1-1V7.414l4.293 4.293c.195.195.45.293.707.293s.512-.098.707-.293c.39-.39.39-1.023 0-1.414z"})));r.metadata={width:24,height:24},t.a=r},o52z:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var s=i("VPAj");const a=Object(s.a)([]);Object(s.a)({})},xAHt:function(e,t,i){"use strict";i.r(t),i.d(t,"NewTweetsPill",(function(){return C}));i("kYxP");var s=i("ERkP"),a=i.n(s),o=i("lnti"),n=i("hqKg"),r=i("o52z"),l=i("G6rE"),c=i("rxPX");const h=(e,t)=>t.alert&&t.alert.userIds||Object(r.a)();var m=Object(c.a)().propsFromState((()=>({userImageUrls:Object(n.createSelector)(l.e.selectAll,h,((e,t)=>t?Object(o.a)(t.map((t=>{const i=e[t];return i?i.profile_image_url_https:void 0}))):[]))}))).withAnalytics({component:"new_tweet_prompt"}),p=i("3XMw"),u=i.n(p),w=i("WXWl"),_=i("IbOt"),d=i("fs1G"),b=i("rcen"),y=i("MWbm"),g=i("I4+6"),T=i("rHpw"),S=i("cm6r"),f=i("MAI/"),v=i("t62R"),D=i("v6aA");const A=u.a.gdb8bdcc,x=u.a.ac0f6491,I={},k={};class C extends a.a.PureComponent{constructor(...e){super(...e),this.state={show:!1},this._getLastShownTime=()=>k[this.props.timelineId],this._hide=()=>{const{alert:e,removeAlert:t,timelineId:i}=this.props;this._mounted&&(this._updateLastShownTime(i),this.setState({show:!1})),e&&setTimeout((()=>t()),500)},this._attemptShow=()=>{const{featureSwitches:e}=this.context,{alert:t,isAtNewest:i,removeAlert:s,timelineId:a,unreadCount:o}=this.props;if(this._attemptShowTimeout&&(clearTimeout(this._attemptShowTimeout),this._attemptShowTimeout=null),this._mounted&&(t||o>0)){const o=this._getDelayRemaining();if(o<=0){if(t&&i())return void s();this.setState({show:!0}),I[a]=Date.now(),this._scribeAction("show");const o=e.isTrue("responsive_web_home_sticky_new_tweets_pill_enabled"),n=e.getNumberValue("responsive_web_home_sticky_new_tweets_pill_duration_seconds",-1);o&&n>0&&(this._autoDismissTimeout=setTimeout(this._hide,1e3*n))}else this._attemptShowTimeout=setTimeout(this._attemptShow,o)}},this._handleScrollDown=()=>{const{featureSwitches:e}=this.context,{alert:t,remainVisibleInterval:i,timelineId:s}=this.props;if(t&&this.state.show&&e.isTrue("responsive_web_home_sticky_new_tweets_pill_enabled"))return;let a=i;t&&t.displayDurationMs&&t.displayDurationMs>-1&&(a=t.displayDurationMs),this.state.show&&Date.now()>=I[s]+a&&(this._scribeAction("dismiss"),this._hide())},this._handleClick=()=>{const{applyNewTweetsBarInstructions:e}=this.props;this._scribeAction("click"),window.scrollTo(0,0),null==e||e(),this._hide()}}componentDidMount(){this._mounted=!0,this._getLastShownTime()||this._updateLastShownTime(this.props.timelineId),this._attemptShow(),this._cancelMomentum=Object(_.a)({onUp:d.a,onDown:this._handleScrollDown})}componentDidUpdate(e,t){const{alert:i,timelineId:s,unreadCount:a}=this.props,o=e.timelineId!==s,n=o&&!this._getLastShownTime();o?(n&&this._updateLastShownTime(s),t.show&&this._updateLastShownTime(e.timelineId),null==e.removeAlert||e.removeAlert(),this.setState({show:!1}),this._attemptShow()):((i&&!t.show||a>e.unreadCount)&&this._attemptShow(),!e.alert&&0!==a||i||this._hide())}componentWillUnmount(){const{removeAlert:e,timelineId:t}=this.props;this._mounted=!1,this._attemptShowTimeout&&clearTimeout(this._attemptShowTimeout),this._autoDismissTimeout&&clearTimeout(this._autoDismissTimeout),this.state.show&&(this._updateLastShownTime(t),null==e||e()),this._cancelMomentum()}render(){const{alert:e,label:t,userImageUrls:i}=this.props,{show:s}=this.state;let o;o=e?e.richText&&a.a.createElement(b.a,{entities:e.richText.entities,text:e.richText.text}):t;const n=g.a.generate({backgroundColor:T.a.theme.colors.primary,color:T.a.theme.colors.whiteOnColor});return a.a.createElement(y.a,{accessibilityRole:"status"},a.a.createElement(S.a,{accessibilityHidden:!s,accessibilityLabel:x,accessibilityRole:"button",interactiveStyles:n,onClick:this._handleClick,style:[L.pill,s&&L.show]},a.a.createElement(y.a,{style:L.innerPill},a.a.createElement(w.a,{style:L.icon}),i&&i.length>0?a.a.createElement(y.a,{style:L.facepile},a.a.createElement(f.a,{borderColor:"primary",userAvatarSize:"large",userAvatarUrls:i})):null,a.a.createElement(v.b,{color:"whiteOnColor",numberOfLines:1,style:L.pillText},o))))}_getDelayRemaining(){const{featureSwitches:e}=this.context,{alert:t,triggerDelay:i}=this.props,s=e.getNumberValue("responsive_web_home_sticky_new_tweets_pill_delay_seconds",1),a=e.isTrue("responsive_web_home_sticky_new_tweets_pill_enabled")&&s>0?1e3*s:t&&t.triggerDelayMs||i;return this._getLastShownTime()+a-Date.now()}_updateLastShownTime(e){e&&(k[e]=Date.now())}_scribeAction(e){const{analytics:t}=this.props;t.scribeAction(e)}}C.contextType=D.a,C.defaultProps={isAtNewest:()=>!0,label:A,remainVisibleInterval:3e3,triggerDelay:24e4,unreadCount:0};const L=T.a.create((e=>({pill:{boxShadow:e.boxShadows.small,backgroundColor:e.colors.primary,borderRadius:e.borderRadii.infinite,paddingHorizontal:e.spaces.space16,opacity:0,justifyContent:"center",transform:[{translate3d:"0, 0, 0"}],transitionProperty:"transform, opacity",transitionDuration:"0.15s",transitionTimingFunction:"ease, ease, step-end"},innerPill:{flexDirection:"row",paddingVertical:e.spaces.space4},icon:{width:e.spaces.space20,marginRight:e.spaces.space4,alignSelf:"center",color:e.colors.whiteOnColor},facepile:{marginRight:e.spaces.space8},pillText:{alignSelf:"center"},show:{opacity:1,transitionTimingFunction:"ease, ease, step-start",transform:[{translate3d:"0, 3.5em, 0"}]}}))),E=m(C);t.default=E}}]);
//# sourceMappingURL=https://ton.local.twitter.com/responsive-web-internal/sourcemaps/client-web/loader.NewTweetsPill.2db7d955.js.map